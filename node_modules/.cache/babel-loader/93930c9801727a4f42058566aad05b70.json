{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WithPermissionComponent = undefined;\n\nvar _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _getContext = require('recompose/getContext');\n\nvar _getContext2 = _interopRequireDefault(_getContext);\n\nvar _types = require('./types');\n\nvar _resolvePermissions = require('./resolvePermissions');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar WithPermissionComponent = exports.WithPermissionComponent = function (_Component) {\n  (0, _inherits3.default)(WithPermissionComponent, _Component);\n\n  function WithPermissionComponent() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    (0, _classCallCheck3.default)(this, WithPermissionComponent);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, (_ref = WithPermissionComponent.__proto__ || Object.getPrototypeOf(WithPermissionComponent)).call.apply(_ref, [this].concat(args))), _this), _this.state = {\n      isNotFound: false,\n      match: undefined,\n      role: undefined\n    }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n  }\n\n  (0, _createClass3.default)(WithPermissionComponent, [{\n    key: 'componentWillMount',\n    value: function () {\n      var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {\n        var _props, authClient, children, record, resolve, resource, requiredPermissions, exact, permissions, match;\n\n        return _regenerator2.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _props = this.props, authClient = _props.authClient, children = _props.children, record = _props.record, resolve = _props.resolve, resource = _props.resource, requiredPermissions = _props.value, exact = _props.exact;\n                _context.next = 3;\n                return authClient(_types.AUTH_GET_PERMISSIONS, {\n                  record: record,\n                  resource: resource\n                });\n\n              case 3:\n                permissions = _context.sent;\n                _context.next = 6;\n                return (0, _resolvePermissions.resolvePermission)({\n                  permissions: permissions,\n                  record: record,\n                  resource: resource\n                })({\n                  exact: exact,\n                  permissions: requiredPermissions,\n                  resolve: resolve,\n                  view: children\n                });\n\n              case 6:\n                match = _context.sent;\n\n                if (match && match.matched) {\n                  this.setState({\n                    match: match.view\n                  });\n                } else {\n                  this.setState({\n                    isNotFound: true,\n                    permissions: permissions\n                  });\n                }\n\n              case 8:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentWillMount() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return componentWillMount;\n    }()\n  }, {\n    key: 'render',\n    value: function render() {\n      var _state = this.state,\n          isNotFound = _state.isNotFound,\n          match = _state.match,\n          role = _state.role;\n      var _props2 = this.props,\n          authClient = _props2.authClient,\n          children = _props2.children,\n          notFound = _props2.notFound,\n          loading = _props2.loading,\n          resource = _props2.resource,\n          record = _props2.record,\n          resolve = _props2.resolve,\n          value = _props2.value,\n          exact = _props2.exact,\n          props = (0, _objectWithoutProperties3.default)(_props2, ['authClient', 'children', 'notFound', 'loading', 'resource', 'record', 'resolve', 'value', 'exact']);\n\n      if (isNotFound) {\n        if (notFound) {\n          return (0, _react.createElement)(notFound, {\n            role: role\n          });\n        }\n\n        return null;\n      }\n\n      if (!match && loading) {\n        return (0, _react.createElement)(loading);\n      }\n\n      if (_react.Children.count(children) > 1) {\n        return _react2.default.createElement('span', null, _react.Children.map(children, function (child) {\n          return child ? (0, _react.cloneElement)(child, props) : null;\n        }));\n      }\n\n      return (0, _react.cloneElement)(children, props);\n    }\n  }]);\n  return WithPermissionComponent;\n}(_react.Component);\n\nWithPermissionComponent.propTypes = {\n  authClient: _propTypes2.default.func,\n  children: _propTypes2.default.node.isRequired,\n  exact: _propTypes2.default.bool,\n  loading: _propTypes2.default.func,\n  notFound: _propTypes2.default.func,\n  record: _propTypes2.default.object,\n  resource: _propTypes2.default.string,\n  value: _propTypes2.default.any,\n  resolve: _propTypes2.default.func\n};\nWithPermissionComponent.defaultProps = {\n  loading: null\n};\nexports.default = (0, _getContext2.default)({\n  authClient: _propTypes2.default.func\n})(WithPermissionComponent);","map":{"version":3,"sources":["C:/Users/m2bab/VM/rd2/frontend/node_modules/admin-on-rest/lib/auth/WithPermission.js"],"names":["Object","defineProperty","exports","value","WithPermissionComponent","undefined","_objectWithoutProperties2","require","_objectWithoutProperties3","_interopRequireDefault","_regenerator","_regenerator2","_asyncToGenerator2","_asyncToGenerator3","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_react","_react2","_propTypes","_propTypes2","_getContext","_getContext2","_types","_resolvePermissions","obj","__esModule","default","_Component","_ref","_temp","_this","_ret","_len","arguments","length","args","Array","_key","__proto__","getPrototypeOf","call","apply","concat","state","isNotFound","match","role","key","_ref2","mark","_callee","_props","authClient","children","record","resolve","resource","requiredPermissions","exact","permissions","wrap","_callee$","_context","prev","next","props","AUTH_GET_PERMISSIONS","sent","resolvePermission","view","matched","setState","stop","componentWillMount","render","_state","_props2","notFound","loading","createElement","Children","count","map","child","cloneElement","Component","propTypes","func","node","isRequired","bool","object","string","any","defaultProps"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.WithPermissionComponent = undefined;\n\nvar _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _getContext = require('recompose/getContext');\n\nvar _getContext2 = _interopRequireDefault(_getContext);\n\nvar _types = require('./types');\n\nvar _resolvePermissions = require('./resolvePermissions');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar WithPermissionComponent = exports.WithPermissionComponent = function (_Component) {\n    (0, _inherits3.default)(WithPermissionComponent, _Component);\n\n    function WithPermissionComponent() {\n        var _ref;\n\n        var _temp, _this, _ret;\n\n        (0, _classCallCheck3.default)(this, WithPermissionComponent);\n\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, (_ref = WithPermissionComponent.__proto__ || Object.getPrototypeOf(WithPermissionComponent)).call.apply(_ref, [this].concat(args))), _this), _this.state = {\n            isNotFound: false,\n            match: undefined,\n            role: undefined\n        }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n    }\n\n    (0, _createClass3.default)(WithPermissionComponent, [{\n        key: 'componentWillMount',\n        value: function () {\n            var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {\n                var _props, authClient, children, record, resolve, resource, requiredPermissions, exact, permissions, match;\n\n                return _regenerator2.default.wrap(function _callee$(_context) {\n                    while (1) {\n                        switch (_context.prev = _context.next) {\n                            case 0:\n                                _props = this.props, authClient = _props.authClient, children = _props.children, record = _props.record, resolve = _props.resolve, resource = _props.resource, requiredPermissions = _props.value, exact = _props.exact;\n                                _context.next = 3;\n                                return authClient(_types.AUTH_GET_PERMISSIONS, {\n                                    record: record,\n                                    resource: resource\n                                });\n\n                            case 3:\n                                permissions = _context.sent;\n                                _context.next = 6;\n                                return (0, _resolvePermissions.resolvePermission)({\n                                    permissions: permissions,\n                                    record: record,\n                                    resource: resource\n                                })({\n                                    exact: exact,\n                                    permissions: requiredPermissions,\n                                    resolve: resolve,\n                                    view: children\n                                });\n\n                            case 6:\n                                match = _context.sent;\n\n\n                                if (match && match.matched) {\n                                    this.setState({ match: match.view });\n                                } else {\n                                    this.setState({ isNotFound: true, permissions: permissions });\n                                }\n\n                            case 8:\n                            case 'end':\n                                return _context.stop();\n                        }\n                    }\n                }, _callee, this);\n            }));\n\n            function componentWillMount() {\n                return _ref2.apply(this, arguments);\n            }\n\n            return componentWillMount;\n        }()\n    }, {\n        key: 'render',\n        value: function render() {\n            var _state = this.state,\n                isNotFound = _state.isNotFound,\n                match = _state.match,\n                role = _state.role;\n            var _props2 = this.props,\n                authClient = _props2.authClient,\n                children = _props2.children,\n                notFound = _props2.notFound,\n                loading = _props2.loading,\n                resource = _props2.resource,\n                record = _props2.record,\n                resolve = _props2.resolve,\n                value = _props2.value,\n                exact = _props2.exact,\n                props = (0, _objectWithoutProperties3.default)(_props2, ['authClient', 'children', 'notFound', 'loading', 'resource', 'record', 'resolve', 'value', 'exact']);\n\n\n            if (isNotFound) {\n                if (notFound) {\n                    return (0, _react.createElement)(notFound, { role: role });\n                }\n\n                return null;\n            }\n\n            if (!match && loading) {\n                return (0, _react.createElement)(loading);\n            }\n\n            if (_react.Children.count(children) > 1) {\n                return _react2.default.createElement(\n                    'span',\n                    null,\n                    _react.Children.map(children, function (child) {\n                        return child ? (0, _react.cloneElement)(child, props) : null;\n                    })\n                );\n            }\n\n            return (0, _react.cloneElement)(children, props);\n        }\n    }]);\n    return WithPermissionComponent;\n}(_react.Component);\n\nWithPermissionComponent.propTypes = {\n    authClient: _propTypes2.default.func,\n    children: _propTypes2.default.node.isRequired,\n    exact: _propTypes2.default.bool,\n    loading: _propTypes2.default.func,\n    notFound: _propTypes2.default.func,\n    record: _propTypes2.default.object,\n    resource: _propTypes2.default.string,\n    value: _propTypes2.default.any,\n    resolve: _propTypes2.default.func\n};\nWithPermissionComponent.defaultProps = {\n    loading: null\n};\nexports.default = (0, _getContext2.default)({\n    authClient: _propTypes2.default.func\n})(WithPermissionComponent);"]},"metadata":{},"sourceType":"script"}