{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReferenceInput = exports.getDataStatus = undefined;\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactRedux = require('react-redux');\n\nvar _lodash = require('lodash.debounce');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _dataActions = require('../../actions/dataActions');\n\nvar _possibleValues = require('../../reducer/admin/references/possibleValues');\n\nvar _ReferenceLoadingProgress = require('./ReferenceLoadingProgress');\n\nvar _ReferenceLoadingProgress2 = _interopRequireDefault(_ReferenceLoadingProgress);\n\nvar _ReferenceError = require('./ReferenceError');\n\nvar _ReferenceError2 = _interopRequireDefault(_ReferenceError);\n\nvar _translate = require('../../i18n/translate');\n\nvar _translate2 = _interopRequireDefault(_translate);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar referenceSource = function referenceSource(resource, source) {\n  return resource + '@' + source;\n};\n\nvar noFilter = function noFilter() {\n  return true;\n};\n\nvar getDataStatus = exports.getDataStatus = function getDataStatus(_ref) {\n  var input = _ref.input,\n      matchingReferences = _ref.matchingReferences,\n      referenceRecord = _ref.referenceRecord,\n      translate = _ref.translate;\n  var matchingReferencesError = matchingReferences && matchingReferences.error ? translate(matchingReferences.error, {\n    _: matchingReferences.error\n  }) : null;\n  var selectedReferenceError = input.value && !referenceRecord ? translate('aor.input.references.single_missing', {\n    _: 'aor.input.references.single_missing'\n  }) : null;\n  return {\n    waiting: input.value && selectedReferenceError && !matchingReferences || !input.value && !matchingReferences,\n    error: input.value && selectedReferenceError && matchingReferencesError || !input.value && matchingReferencesError ? input.value ? selectedReferenceError : matchingReferencesError : null,\n    warning: selectedReferenceError || matchingReferencesError,\n    choices: Array.isArray(matchingReferences) ? matchingReferences : [referenceRecord].filter(function (choice) {\n      return choice;\n    })\n  };\n};\n/**\n * An Input component for choosing a reference record. Useful for foreign keys.\n *\n * This component fetches the possible values in the reference resource\n * (using the `CRUD_GET_MATCHING` REST method), then delegates rendering\n * to a subcomponent, to which it passes the possible choices\n * as the `choices` attribute.\n *\n * Use it with a selector component as child, like `<AutocompleteInput>`,\n * `<SelectInput>`, or `<RadioButtonGroupInput>`.\n *\n * @example\n * export const CommentEdit = (props) => (\n *     <Edit {...props}>\n *         <SimpleForm>\n *             <ReferenceInput label=\"Post\" source=\"post_id\" reference=\"posts\">\n *                 <AutocompleteInput optionText=\"title\" />\n *             </ReferenceInput>\n *         </SimpleForm>\n *     </Edit>\n * );\n *\n * @example\n * export const CommentEdit = (props) => (\n *     <Edit {...props}>\n *         <SimpleForm>\n *             <ReferenceInput label=\"Post\" source=\"post_id\" reference=\"posts\">\n *                 <SelectInput optionText=\"title\" />\n *             </ReferenceInput>\n *         </SimpleForm>\n *     </Edit>\n * );\n *\n * By default, restricts the possible values to 25. You can extend this limit\n * by setting the `perPage` prop.\n *\n * @example\n * <ReferenceInput\n *      source=\"post_id\"\n *      reference=\"posts\"\n *      perPage={100}>\n *     <SelectInput optionText=\"title\" />\n * </ReferenceInput>\n *\n * By default, orders the possible values by id desc. You can change this order\n * by setting the `sort` prop (an object with `field` and `order` properties).\n *\n * @example\n * <ReferenceInput\n *      source=\"post_id\"\n *      reference=\"posts\"\n *      sort={{ field: 'title', order: 'ASC' }}>\n *     <SelectInput optionText=\"title\" />\n * </ReferenceInput>\n *\n * Also, you can filter the query used to populate the possible values. Use the\n * `filter` prop for that.\n *\n * @example\n * <ReferenceInput\n *      source=\"post_id\"\n *      reference=\"posts\"\n *      filter={{ is_published: true }}>\n *     <SelectInput optionText=\"title\" />\n * </ReferenceInput>\n *\n * The enclosed component may filter results. ReferenceInput passes a `setFilter`\n * function as prop to its child component. It uses the value to create a filter\n * for the query - by default { q: [searchText] }. You can customize the mapping\n * searchText => searchQuery by setting a custom `filterToQuery` function prop:\n *\n * @example\n * <ReferenceInput\n *      source=\"post_id\"\n *      reference=\"posts\"\n *      filterToQuery={searchText => ({ title: searchText })}>\n *     <SelectInput optionText=\"title\" />\n * </ReferenceInput>\n */\n\n\nvar ReferenceInput = exports.ReferenceInput = function (_Component) {\n  (0, _inherits3.default)(ReferenceInput, _Component);\n\n  function ReferenceInput(props) {\n    (0, _classCallCheck3.default)(this, ReferenceInput);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (ReferenceInput.__proto__ || Object.getPrototypeOf(ReferenceInput)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var perPage = props.perPage,\n        sort = props.sort,\n        filter = props.filter; // stored as a property rather than state because we don't want redraw of async updates\n\n    _this.params = {\n      pagination: {\n        page: 1,\n        perPage: perPage\n      },\n      sort: sort,\n      filter: filter\n    };\n    _this.debouncedSetFilter = (0, _lodash2.default)(_this.setFilter.bind(_this), 500);\n    return _this;\n  }\n\n  (0, _createClass3.default)(ReferenceInput, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.fetchReferenceAndOptions();\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (this.props.record.id !== nextProps.record.id) {\n        this.fetchReferenceAndOptions(nextProps);\n      }\n    }\n  }, {\n    key: 'fetchReferenceAndOptions',\n    value: function fetchReferenceAndOptions() {\n      var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props,\n          input = _ref2.input,\n          reference = _ref2.reference,\n          source = _ref2.source,\n          resource = _ref2.resource;\n\n      var filterFromProps = this.props.filter;\n      var _params = this.params,\n          pagination = _params.pagination,\n          sort = _params.sort,\n          filter = _params.filter;\n      var id = input.value;\n\n      if (id) {\n        this.props.crudGetOne(reference, id, null, false);\n      }\n\n      var finalFilter = (0, _extends3.default)({}, filterFromProps, filter);\n      this.props.crudGetMatching(reference, referenceSource(resource, source), pagination, sort, finalFilter);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          input = _props.input,\n          resource = _props.resource,\n          label = _props.label,\n          source = _props.source,\n          allowEmpty = _props.allowEmpty,\n          matchingReferences = _props.matchingReferences,\n          referenceRecord = _props.referenceRecord,\n          basePath = _props.basePath,\n          onChange = _props.onChange,\n          children = _props.children,\n          meta = _props.meta,\n          translate = _props.translate;\n\n      if (_react2.default.Children.count(children) !== 1) {\n        throw new Error('<ReferenceInput> only accepts a single child');\n      }\n\n      var translatedLabel = translate(label || 'resources.' + resource + '.fields.' + source);\n      var dataStatus = getDataStatus({\n        input: input,\n        matchingReferences: matchingReferences,\n        referenceRecord: referenceRecord,\n        translate: translate\n      });\n\n      if (dataStatus.waiting) {\n        return _react2.default.createElement(_ReferenceLoadingProgress2.default, {\n          label: translatedLabel\n        });\n      }\n\n      if (dataStatus.error) {\n        return _react2.default.createElement(_ReferenceError2.default, {\n          label: translatedLabel,\n          error: dataStatus.error\n        });\n      }\n\n      return _react2.default.cloneElement(children, {\n        allowEmpty: allowEmpty,\n        input: input,\n        label: translatedLabel,\n        resource: resource,\n        meta: dataStatus.warning ? (0, _extends3.default)({}, meta, {\n          error: dataStatus.warning,\n          touched: true\n        }) : meta,\n        source: source,\n        choices: dataStatus.choices,\n        basePath: basePath,\n        onChange: onChange,\n        filter: noFilter,\n        // for AutocompleteInput\n        setFilter: this.debouncedSetFilter,\n        setPagination: this.setPagination,\n        setSort: this.setSort,\n        translateChoice: false\n      });\n    }\n  }]);\n  return ReferenceInput;\n}(_react.Component);\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.setFilter = function (filter) {\n    if (filter !== _this2.params.filter) {\n      _this2.params.filter = _this2.props.filterToQuery(filter);\n\n      _this2.fetchReferenceAndOptions();\n    }\n  };\n\n  this.setPagination = function (pagination) {\n    if (pagination !== _this2.param.pagination) {\n      _this2.param.pagination = pagination;\n\n      _this2.fetchReferenceAndOptions();\n    }\n  };\n\n  this.setSort = function (sort) {\n    if (sort !== _this2.params.sort) {\n      _this2.params.sort = sort;\n\n      _this2.fetchReferenceAndOptions();\n    }\n  };\n};\n\nReferenceInput.propTypes = {\n  addField: _propTypes2.default.bool.isRequired,\n  allowEmpty: _propTypes2.default.bool.isRequired,\n  basePath: _propTypes2.default.string,\n  children: _propTypes2.default.element.isRequired,\n  crudGetMatching: _propTypes2.default.func.isRequired,\n  crudGetOne: _propTypes2.default.func.isRequired,\n  filter: _propTypes2.default.object,\n  filterToQuery: _propTypes2.default.func.isRequired,\n  input: _propTypes2.default.object.isRequired,\n  label: _propTypes2.default.string,\n  matchingReferences: _propTypes2.default.array,\n  meta: _propTypes2.default.object,\n  onChange: _propTypes2.default.func,\n  perPage: _propTypes2.default.number,\n  reference: _propTypes2.default.string.isRequired,\n  referenceRecord: _propTypes2.default.object,\n  resource: _propTypes2.default.string.isRequired,\n  sort: _propTypes2.default.shape({\n    field: _propTypes2.default.string,\n    order: _propTypes2.default.oneOf(['ASC', 'DESC'])\n  }),\n  source: _propTypes2.default.string,\n  translate: _propTypes2.default.func.isRequired\n};\nReferenceInput.defaultProps = {\n  addField: true,\n  allowEmpty: false,\n  filter: {},\n  filterToQuery: function filterToQuery(searchText) {\n    return {\n      q: searchText\n    };\n  },\n  matchingReferences: null,\n  perPage: 25,\n  referenceRecord: null,\n  sort: {\n    field: 'id',\n    order: 'DESC'\n  }\n};\n\nfunction mapStateToProps(state, props) {\n  var referenceId = props.input.value;\n  return {\n    matchingReferences: (0, _possibleValues.getPossibleReferences)(state, referenceSource(props.resource, props.source), props.reference, [referenceId]),\n    referenceRecord: state.admin.resources[props.reference].data[referenceId]\n  };\n}\n\nvar ConnectedReferenceInput = (0, _reactRedux.connect)(mapStateToProps, {\n  crudGetOne: _dataActions.crudGetOne,\n  crudGetMatching: _dataActions.crudGetMatching\n})(ReferenceInput);\nConnectedReferenceInput.defaultProps = {\n  addField: true\n};\nexports.default = (0, _translate2.default)(ConnectedReferenceInput);","map":{"version":3,"sources":["C:/Users/m2bab/VM/rd2/frontend/node_modules/admin-on-rest/lib/mui/input/ReferenceInput.js"],"names":["Object","defineProperty","exports","value","ReferenceInput","getDataStatus","undefined","_extends2","require","_extends3","_interopRequireDefault","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_react","_react2","_propTypes","_propTypes2","_reactRedux","_lodash","_lodash2","_dataActions","_possibleValues","_ReferenceLoadingProgress","_ReferenceLoadingProgress2","_ReferenceError","_ReferenceError2","_translate","_translate2","obj","__esModule","default","referenceSource","resource","source","noFilter","_ref","input","matchingReferences","referenceRecord","translate","matchingReferencesError","error","_","selectedReferenceError","waiting","warning","choices","Array","isArray","filter","choice","_Component","props","_this","__proto__","getPrototypeOf","call","_initialiseProps","perPage","sort","params","pagination","page","debouncedSetFilter","setFilter","bind","key","componentDidMount","fetchReferenceAndOptions","componentWillReceiveProps","nextProps","record","id","_ref2","arguments","length","reference","filterFromProps","_params","crudGetOne","finalFilter","crudGetMatching","render","_props","label","allowEmpty","basePath","onChange","children","meta","Children","count","Error","translatedLabel","dataStatus","createElement","cloneElement","touched","setPagination","setSort","translateChoice","Component","_this2","filterToQuery","param","propTypes","addField","bool","isRequired","string","element","func","object","array","number","shape","field","order","oneOf","defaultProps","searchText","q","mapStateToProps","state","referenceId","getPossibleReferences","admin","resources","data","ConnectedReferenceInput","connect"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ReferenceInput = exports.getDataStatus = undefined;\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactRedux = require('react-redux');\n\nvar _lodash = require('lodash.debounce');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _dataActions = require('../../actions/dataActions');\n\nvar _possibleValues = require('../../reducer/admin/references/possibleValues');\n\nvar _ReferenceLoadingProgress = require('./ReferenceLoadingProgress');\n\nvar _ReferenceLoadingProgress2 = _interopRequireDefault(_ReferenceLoadingProgress);\n\nvar _ReferenceError = require('./ReferenceError');\n\nvar _ReferenceError2 = _interopRequireDefault(_ReferenceError);\n\nvar _translate = require('../../i18n/translate');\n\nvar _translate2 = _interopRequireDefault(_translate);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar referenceSource = function referenceSource(resource, source) {\n    return resource + '@' + source;\n};\nvar noFilter = function noFilter() {\n    return true;\n};\n\nvar getDataStatus = exports.getDataStatus = function getDataStatus(_ref) {\n    var input = _ref.input,\n        matchingReferences = _ref.matchingReferences,\n        referenceRecord = _ref.referenceRecord,\n        translate = _ref.translate;\n\n    var matchingReferencesError = matchingReferences && matchingReferences.error ? translate(matchingReferences.error, {\n        _: matchingReferences.error\n    }) : null;\n    var selectedReferenceError = input.value && !referenceRecord ? translate('aor.input.references.single_missing', {\n        _: 'aor.input.references.single_missing'\n    }) : null;\n\n    return {\n        waiting: input.value && selectedReferenceError && !matchingReferences || !input.value && !matchingReferences,\n        error: input.value && selectedReferenceError && matchingReferencesError || !input.value && matchingReferencesError ? input.value ? selectedReferenceError : matchingReferencesError : null,\n        warning: selectedReferenceError || matchingReferencesError,\n        choices: Array.isArray(matchingReferences) ? matchingReferences : [referenceRecord].filter(function (choice) {\n            return choice;\n        })\n    };\n};\n\n/**\n * An Input component for choosing a reference record. Useful for foreign keys.\n *\n * This component fetches the possible values in the reference resource\n * (using the `CRUD_GET_MATCHING` REST method), then delegates rendering\n * to a subcomponent, to which it passes the possible choices\n * as the `choices` attribute.\n *\n * Use it with a selector component as child, like `<AutocompleteInput>`,\n * `<SelectInput>`, or `<RadioButtonGroupInput>`.\n *\n * @example\n * export const CommentEdit = (props) => (\n *     <Edit {...props}>\n *         <SimpleForm>\n *             <ReferenceInput label=\"Post\" source=\"post_id\" reference=\"posts\">\n *                 <AutocompleteInput optionText=\"title\" />\n *             </ReferenceInput>\n *         </SimpleForm>\n *     </Edit>\n * );\n *\n * @example\n * export const CommentEdit = (props) => (\n *     <Edit {...props}>\n *         <SimpleForm>\n *             <ReferenceInput label=\"Post\" source=\"post_id\" reference=\"posts\">\n *                 <SelectInput optionText=\"title\" />\n *             </ReferenceInput>\n *         </SimpleForm>\n *     </Edit>\n * );\n *\n * By default, restricts the possible values to 25. You can extend this limit\n * by setting the `perPage` prop.\n *\n * @example\n * <ReferenceInput\n *      source=\"post_id\"\n *      reference=\"posts\"\n *      perPage={100}>\n *     <SelectInput optionText=\"title\" />\n * </ReferenceInput>\n *\n * By default, orders the possible values by id desc. You can change this order\n * by setting the `sort` prop (an object with `field` and `order` properties).\n *\n * @example\n * <ReferenceInput\n *      source=\"post_id\"\n *      reference=\"posts\"\n *      sort={{ field: 'title', order: 'ASC' }}>\n *     <SelectInput optionText=\"title\" />\n * </ReferenceInput>\n *\n * Also, you can filter the query used to populate the possible values. Use the\n * `filter` prop for that.\n *\n * @example\n * <ReferenceInput\n *      source=\"post_id\"\n *      reference=\"posts\"\n *      filter={{ is_published: true }}>\n *     <SelectInput optionText=\"title\" />\n * </ReferenceInput>\n *\n * The enclosed component may filter results. ReferenceInput passes a `setFilter`\n * function as prop to its child component. It uses the value to create a filter\n * for the query - by default { q: [searchText] }. You can customize the mapping\n * searchText => searchQuery by setting a custom `filterToQuery` function prop:\n *\n * @example\n * <ReferenceInput\n *      source=\"post_id\"\n *      reference=\"posts\"\n *      filterToQuery={searchText => ({ title: searchText })}>\n *     <SelectInput optionText=\"title\" />\n * </ReferenceInput>\n */\n\nvar ReferenceInput = exports.ReferenceInput = function (_Component) {\n    (0, _inherits3.default)(ReferenceInput, _Component);\n\n    function ReferenceInput(props) {\n        (0, _classCallCheck3.default)(this, ReferenceInput);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (ReferenceInput.__proto__ || Object.getPrototypeOf(ReferenceInput)).call(this, props));\n\n        _initialiseProps.call(_this);\n\n        var perPage = props.perPage,\n            sort = props.sort,\n            filter = props.filter;\n        // stored as a property rather than state because we don't want redraw of async updates\n\n        _this.params = { pagination: { page: 1, perPage: perPage }, sort: sort, filter: filter };\n        _this.debouncedSetFilter = (0, _lodash2.default)(_this.setFilter.bind(_this), 500);\n        return _this;\n    }\n\n    (0, _createClass3.default)(ReferenceInput, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            this.fetchReferenceAndOptions();\n        }\n    }, {\n        key: 'componentWillReceiveProps',\n        value: function componentWillReceiveProps(nextProps) {\n            if (this.props.record.id !== nextProps.record.id) {\n                this.fetchReferenceAndOptions(nextProps);\n            }\n        }\n    }, {\n        key: 'fetchReferenceAndOptions',\n        value: function fetchReferenceAndOptions() {\n            var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props,\n                input = _ref2.input,\n                reference = _ref2.reference,\n                source = _ref2.source,\n                resource = _ref2.resource;\n\n            var filterFromProps = this.props.filter;\n            var _params = this.params,\n                pagination = _params.pagination,\n                sort = _params.sort,\n                filter = _params.filter;\n\n\n            var id = input.value;\n            if (id) {\n                this.props.crudGetOne(reference, id, null, false);\n            }\n            var finalFilter = (0, _extends3.default)({}, filterFromProps, filter);\n            this.props.crudGetMatching(reference, referenceSource(resource, source), pagination, sort, finalFilter);\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _props = this.props,\n                input = _props.input,\n                resource = _props.resource,\n                label = _props.label,\n                source = _props.source,\n                allowEmpty = _props.allowEmpty,\n                matchingReferences = _props.matchingReferences,\n                referenceRecord = _props.referenceRecord,\n                basePath = _props.basePath,\n                onChange = _props.onChange,\n                children = _props.children,\n                meta = _props.meta,\n                translate = _props.translate;\n\n\n            if (_react2.default.Children.count(children) !== 1) {\n                throw new Error('<ReferenceInput> only accepts a single child');\n            }\n\n            var translatedLabel = translate(label || 'resources.' + resource + '.fields.' + source);\n            var dataStatus = getDataStatus({\n                input: input,\n                matchingReferences: matchingReferences,\n                referenceRecord: referenceRecord,\n                translate: translate\n            });\n\n            if (dataStatus.waiting) {\n                return _react2.default.createElement(_ReferenceLoadingProgress2.default, { label: translatedLabel });\n            }\n\n            if (dataStatus.error) {\n                return _react2.default.createElement(_ReferenceError2.default, {\n                    label: translatedLabel,\n                    error: dataStatus.error\n                });\n            }\n\n            return _react2.default.cloneElement(children, {\n                allowEmpty: allowEmpty,\n                input: input,\n                label: translatedLabel,\n                resource: resource,\n                meta: dataStatus.warning ? (0, _extends3.default)({}, meta, {\n                    error: dataStatus.warning,\n                    touched: true\n                }) : meta,\n                source: source,\n                choices: dataStatus.choices,\n                basePath: basePath,\n                onChange: onChange,\n                filter: noFilter, // for AutocompleteInput\n                setFilter: this.debouncedSetFilter,\n                setPagination: this.setPagination,\n                setSort: this.setSort,\n                translateChoice: false\n            });\n        }\n    }]);\n    return ReferenceInput;\n}(_react.Component);\n\nvar _initialiseProps = function _initialiseProps() {\n    var _this2 = this;\n\n    this.setFilter = function (filter) {\n        if (filter !== _this2.params.filter) {\n            _this2.params.filter = _this2.props.filterToQuery(filter);\n            _this2.fetchReferenceAndOptions();\n        }\n    };\n\n    this.setPagination = function (pagination) {\n        if (pagination !== _this2.param.pagination) {\n            _this2.param.pagination = pagination;\n            _this2.fetchReferenceAndOptions();\n        }\n    };\n\n    this.setSort = function (sort) {\n        if (sort !== _this2.params.sort) {\n            _this2.params.sort = sort;\n            _this2.fetchReferenceAndOptions();\n        }\n    };\n};\n\nReferenceInput.propTypes = {\n    addField: _propTypes2.default.bool.isRequired,\n    allowEmpty: _propTypes2.default.bool.isRequired,\n    basePath: _propTypes2.default.string,\n    children: _propTypes2.default.element.isRequired,\n    crudGetMatching: _propTypes2.default.func.isRequired,\n    crudGetOne: _propTypes2.default.func.isRequired,\n    filter: _propTypes2.default.object,\n    filterToQuery: _propTypes2.default.func.isRequired,\n    input: _propTypes2.default.object.isRequired,\n    label: _propTypes2.default.string,\n    matchingReferences: _propTypes2.default.array,\n    meta: _propTypes2.default.object,\n    onChange: _propTypes2.default.func,\n    perPage: _propTypes2.default.number,\n    reference: _propTypes2.default.string.isRequired,\n    referenceRecord: _propTypes2.default.object,\n    resource: _propTypes2.default.string.isRequired,\n    sort: _propTypes2.default.shape({\n        field: _propTypes2.default.string,\n        order: _propTypes2.default.oneOf(['ASC', 'DESC'])\n    }),\n    source: _propTypes2.default.string,\n    translate: _propTypes2.default.func.isRequired\n};\n\nReferenceInput.defaultProps = {\n    addField: true,\n    allowEmpty: false,\n    filter: {},\n    filterToQuery: function filterToQuery(searchText) {\n        return { q: searchText };\n    },\n    matchingReferences: null,\n    perPage: 25,\n    referenceRecord: null,\n    sort: { field: 'id', order: 'DESC' }\n};\n\nfunction mapStateToProps(state, props) {\n    var referenceId = props.input.value;\n    return {\n        matchingReferences: (0, _possibleValues.getPossibleReferences)(state, referenceSource(props.resource, props.source), props.reference, [referenceId]),\n        referenceRecord: state.admin.resources[props.reference].data[referenceId]\n    };\n}\n\nvar ConnectedReferenceInput = (0, _reactRedux.connect)(mapStateToProps, {\n    crudGetOne: _dataActions.crudGetOne,\n    crudGetMatching: _dataActions.crudGetMatching\n})(ReferenceInput);\n\nConnectedReferenceInput.defaultProps = {\n    addField: true\n};\n\nexports.default = (0, _translate2.default)(ConnectedReferenceInput);"]},"metadata":{},"sourceType":"script"}