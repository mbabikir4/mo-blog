{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReferenceField = undefined;\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactRedux = require('react-redux');\n\nvar _reactRouterDom = require('react-router-dom');\n\nvar _LinearProgress = require('material-ui/LinearProgress');\n\nvar _LinearProgress2 = _interopRequireDefault(_LinearProgress);\n\nvar _lodash = require('lodash.get');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _muiThemeable = require('material-ui/styles/muiThemeable');\n\nvar _muiThemeable2 = _interopRequireDefault(_muiThemeable);\n\nvar _compose = require('recompose/compose');\n\nvar _compose2 = _interopRequireDefault(_compose);\n\nvar _accumulateActions = require('../../actions/accumulateActions');\n\nvar _linkToRecord = require('../../util/linkToRecord');\n\nvar _linkToRecord2 = _interopRequireDefault(_linkToRecord);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar getStyles = function getStyles(muiTheme) {\n  return {\n    link: {\n      color: muiTheme.palette.accent1Color\n    }\n  };\n};\n/**\n * Fetch reference record, and delegate rendering to child component.\n *\n * The reference prop sould be the name of one of the <Resource> components\n * added as <Admin> child.\n *\n * @example\n * <ReferenceField label=\"User\" source=\"userId\" reference=\"users\">\n *     <TextField source=\"name\" />\n * </ReferenceField>\n *\n * By default, includes a link to the <Edit> page of the related record\n * (`/users/:userId` in the previous example).\n *\n * Set the linkType prop to \"show\" to link to the <Show> page instead.\n *\n * @example\n * <ReferenceField label=\"User\" source=\"userId\" reference=\"users\" linkType=\"show\">\n *     <TextField source=\"name\" />\n * </ReferenceField>\n *\n * You can also prevent `<ReferenceField>` from adding link to children by setting\n * `linkType` to false.\n *\n * @example\n * <ReferenceField label=\"User\" source=\"userId\" reference=\"users\" linkType={false}>\n *     <TextField source=\"name\" />\n * </ReferenceField>\n */\n\n\nvar ReferenceField = exports.ReferenceField = function (_Component) {\n  (0, _inherits3.default)(ReferenceField, _Component);\n\n  function ReferenceField() {\n    (0, _classCallCheck3.default)(this, ReferenceField);\n    return (0, _possibleConstructorReturn3.default)(this, (ReferenceField.__proto__ || Object.getPrototypeOf(ReferenceField)).apply(this, arguments));\n  }\n\n  (0, _createClass3.default)(ReferenceField, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.fetchReference(this.props);\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (this.props.record.id !== nextProps.record.id) {\n        this.fetchReference(nextProps);\n      }\n    }\n  }, {\n    key: 'fetchReference',\n    value: function fetchReference(props) {\n      var source = (0, _lodash2.default)(props.record, props.source);\n\n      if (source !== null && typeof source !== 'undefined') {\n        this.props.crudGetManyAccumulate(props.reference, [source]);\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          record = _props.record,\n          source = _props.source,\n          reference = _props.reference,\n          referenceRecord = _props.referenceRecord,\n          basePath = _props.basePath,\n          allowEmpty = _props.allowEmpty,\n          children = _props.children,\n          elStyle = _props.elStyle,\n          linkType = _props.linkType,\n          muiTheme = _props.muiTheme;\n\n      if (_react2.default.Children.count(children) !== 1) {\n        throw new Error('<ReferenceField> only accepts a single child');\n      }\n\n      if (!referenceRecord && !allowEmpty) {\n        return _react2.default.createElement(_LinearProgress2.default, null);\n      }\n\n      var rootPath = basePath.split('/').slice(0, -1).join('/');\n      var href = (0, _linkToRecord2.default)(rootPath + '/' + reference, (0, _lodash2.default)(record, source));\n      var linkStyle = (0, _extends3.default)({}, getStyles(muiTheme).link, elStyle);\n\n      var child = _react2.default.cloneElement(children, {\n        record: referenceRecord,\n        resource: reference,\n        allowEmpty: allowEmpty,\n        basePath: basePath,\n        translateChoice: false\n      });\n\n      if (linkType === 'edit' || linkType === true) {\n        return _react2.default.createElement(_reactRouterDom.Link, {\n          style: linkStyle,\n          to: href\n        }, child);\n      }\n\n      if (linkType === 'show') {\n        return _react2.default.createElement(_reactRouterDom.Link, {\n          style: linkStyle,\n          to: href + '/show'\n        }, child);\n      }\n\n      return child;\n    }\n  }]);\n  return ReferenceField;\n}(_react.Component);\n\nReferenceField.propTypes = {\n  addLabel: _propTypes2.default.bool,\n  allowEmpty: _propTypes2.default.bool.isRequired,\n  basePath: _propTypes2.default.string.isRequired,\n  children: _propTypes2.default.element.isRequired,\n  crudGetManyAccumulate: _propTypes2.default.func.isRequired,\n  elStyle: _propTypes2.default.object,\n  label: _propTypes2.default.string,\n  record: _propTypes2.default.object,\n  reference: _propTypes2.default.string.isRequired,\n  referenceRecord: _propTypes2.default.object,\n  source: _propTypes2.default.string.isRequired,\n  linkType: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.bool]).isRequired\n};\nReferenceField.defaultProps = {\n  referenceRecord: null,\n  record: {},\n  allowEmpty: false,\n  linkType: 'edit'\n};\n\nfunction mapStateToProps(state, props) {\n  return {\n    referenceRecord: state.admin.resources[props.reference].data[(0, _lodash2.default)(props.record, props.source)]\n  };\n}\n\nvar ConnectedReferenceField = (0, _compose2.default)((0, _reactRedux.connect)(mapStateToProps, {\n  crudGetManyAccumulate: _accumulateActions.crudGetManyAccumulate\n}), (0, _muiThemeable2.default)())(ReferenceField);\nConnectedReferenceField.defaultProps = {\n  addLabel: true\n};\nexports.default = ConnectedReferenceField;","map":{"version":3,"sources":["C:/Users/m2bab/VM/rd2/frontend/node_modules/admin-on-rest/lib/mui/field/ReferenceField.js"],"names":["Object","defineProperty","exports","value","ReferenceField","undefined","_extends2","require","_extends3","_interopRequireDefault","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_react","_react2","_propTypes","_propTypes2","_reactRedux","_reactRouterDom","_LinearProgress","_LinearProgress2","_lodash","_lodash2","_muiThemeable","_muiThemeable2","_compose","_compose2","_accumulateActions","_linkToRecord","_linkToRecord2","obj","__esModule","default","getStyles","muiTheme","link","color","palette","accent1Color","_Component","__proto__","getPrototypeOf","apply","arguments","key","componentDidMount","fetchReference","props","componentWillReceiveProps","nextProps","record","id","source","crudGetManyAccumulate","reference","render","_props","referenceRecord","basePath","allowEmpty","children","elStyle","linkType","Children","count","Error","createElement","rootPath","split","slice","join","href","linkStyle","child","cloneElement","resource","translateChoice","Link","style","to","Component","propTypes","addLabel","bool","isRequired","string","element","func","object","label","oneOfType","defaultProps","mapStateToProps","state","admin","resources","data","ConnectedReferenceField","connect"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ReferenceField = undefined;\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactRedux = require('react-redux');\n\nvar _reactRouterDom = require('react-router-dom');\n\nvar _LinearProgress = require('material-ui/LinearProgress');\n\nvar _LinearProgress2 = _interopRequireDefault(_LinearProgress);\n\nvar _lodash = require('lodash.get');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _muiThemeable = require('material-ui/styles/muiThemeable');\n\nvar _muiThemeable2 = _interopRequireDefault(_muiThemeable);\n\nvar _compose = require('recompose/compose');\n\nvar _compose2 = _interopRequireDefault(_compose);\n\nvar _accumulateActions = require('../../actions/accumulateActions');\n\nvar _linkToRecord = require('../../util/linkToRecord');\n\nvar _linkToRecord2 = _interopRequireDefault(_linkToRecord);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar getStyles = function getStyles(muiTheme) {\n    return {\n        link: {\n            color: muiTheme.palette.accent1Color\n        }\n    };\n};\n\n/**\n * Fetch reference record, and delegate rendering to child component.\n *\n * The reference prop sould be the name of one of the <Resource> components\n * added as <Admin> child.\n *\n * @example\n * <ReferenceField label=\"User\" source=\"userId\" reference=\"users\">\n *     <TextField source=\"name\" />\n * </ReferenceField>\n *\n * By default, includes a link to the <Edit> page of the related record\n * (`/users/:userId` in the previous example).\n *\n * Set the linkType prop to \"show\" to link to the <Show> page instead.\n *\n * @example\n * <ReferenceField label=\"User\" source=\"userId\" reference=\"users\" linkType=\"show\">\n *     <TextField source=\"name\" />\n * </ReferenceField>\n *\n * You can also prevent `<ReferenceField>` from adding link to children by setting\n * `linkType` to false.\n *\n * @example\n * <ReferenceField label=\"User\" source=\"userId\" reference=\"users\" linkType={false}>\n *     <TextField source=\"name\" />\n * </ReferenceField>\n */\n\nvar ReferenceField = exports.ReferenceField = function (_Component) {\n    (0, _inherits3.default)(ReferenceField, _Component);\n\n    function ReferenceField() {\n        (0, _classCallCheck3.default)(this, ReferenceField);\n        return (0, _possibleConstructorReturn3.default)(this, (ReferenceField.__proto__ || Object.getPrototypeOf(ReferenceField)).apply(this, arguments));\n    }\n\n    (0, _createClass3.default)(ReferenceField, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            this.fetchReference(this.props);\n        }\n    }, {\n        key: 'componentWillReceiveProps',\n        value: function componentWillReceiveProps(nextProps) {\n            if (this.props.record.id !== nextProps.record.id) {\n                this.fetchReference(nextProps);\n            }\n        }\n    }, {\n        key: 'fetchReference',\n        value: function fetchReference(props) {\n            var source = (0, _lodash2.default)(props.record, props.source);\n            if (source !== null && typeof source !== 'undefined') {\n                this.props.crudGetManyAccumulate(props.reference, [source]);\n            }\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _props = this.props,\n                record = _props.record,\n                source = _props.source,\n                reference = _props.reference,\n                referenceRecord = _props.referenceRecord,\n                basePath = _props.basePath,\n                allowEmpty = _props.allowEmpty,\n                children = _props.children,\n                elStyle = _props.elStyle,\n                linkType = _props.linkType,\n                muiTheme = _props.muiTheme;\n\n            if (_react2.default.Children.count(children) !== 1) {\n                throw new Error('<ReferenceField> only accepts a single child');\n            }\n            if (!referenceRecord && !allowEmpty) {\n                return _react2.default.createElement(_LinearProgress2.default, null);\n            }\n            var rootPath = basePath.split('/').slice(0, -1).join('/');\n            var href = (0, _linkToRecord2.default)(rootPath + '/' + reference, (0, _lodash2.default)(record, source));\n            var linkStyle = (0, _extends3.default)({}, getStyles(muiTheme).link, elStyle);\n\n            var child = _react2.default.cloneElement(children, {\n                record: referenceRecord,\n                resource: reference,\n                allowEmpty: allowEmpty,\n                basePath: basePath,\n                translateChoice: false\n            });\n\n            if (linkType === 'edit' || linkType === true) {\n                return _react2.default.createElement(\n                    _reactRouterDom.Link,\n                    { style: linkStyle, to: href },\n                    child\n                );\n            }\n            if (linkType === 'show') {\n                return _react2.default.createElement(\n                    _reactRouterDom.Link,\n                    { style: linkStyle, to: href + '/show' },\n                    child\n                );\n            }\n            return child;\n        }\n    }]);\n    return ReferenceField;\n}(_react.Component);\n\nReferenceField.propTypes = {\n    addLabel: _propTypes2.default.bool,\n    allowEmpty: _propTypes2.default.bool.isRequired,\n    basePath: _propTypes2.default.string.isRequired,\n    children: _propTypes2.default.element.isRequired,\n    crudGetManyAccumulate: _propTypes2.default.func.isRequired,\n    elStyle: _propTypes2.default.object,\n    label: _propTypes2.default.string,\n    record: _propTypes2.default.object,\n    reference: _propTypes2.default.string.isRequired,\n    referenceRecord: _propTypes2.default.object,\n    source: _propTypes2.default.string.isRequired,\n    linkType: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.bool]).isRequired\n};\n\nReferenceField.defaultProps = {\n    referenceRecord: null,\n    record: {},\n    allowEmpty: false,\n    linkType: 'edit'\n};\n\nfunction mapStateToProps(state, props) {\n    return {\n        referenceRecord: state.admin.resources[props.reference].data[(0, _lodash2.default)(props.record, props.source)]\n    };\n}\n\nvar ConnectedReferenceField = (0, _compose2.default)((0, _reactRedux.connect)(mapStateToProps, {\n    crudGetManyAccumulate: _accumulateActions.crudGetManyAccumulate\n}), (0, _muiThemeable2.default)())(ReferenceField);\n\nConnectedReferenceField.defaultProps = {\n    addLabel: true\n};\n\nexports.default = ConnectedReferenceField;"]},"metadata":{},"sourceType":"script"}