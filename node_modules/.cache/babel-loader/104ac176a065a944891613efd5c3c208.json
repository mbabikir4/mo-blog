{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nexports.default = _callee;\n\nvar _effects = require('redux-saga/effects');\n\nvar _reactRouterRedux = require('react-router-redux');\n\nvar _reduxForm = require('redux-form');\n\nvar _dataActions = require('../../actions/dataActions');\n\nvar _notificationActions = require('../../actions/notificationActions');\n\nvar _resolveRedirectTo = require('../../util/resolveRedirectTo');\n\nvar _resolveRedirectTo2 = _interopRequireDefault(_resolveRedirectTo);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar _marked = /*#__PURE__*/_regenerator2.default.mark(handleResponse),\n    _marked2 = /*#__PURE__*/_regenerator2.default.mark(_callee);\n/**\n * Side effects for fetch responses\n *\n * Mostly redirects and notifications\n */\n\n\nfunction handleResponse(_ref) {\n  var type = _ref.type,\n      requestPayload = _ref.requestPayload,\n      error = _ref.error,\n      payload = _ref.payload;\n  var errorMessage;\n  return _regenerator2.default.wrap(function handleResponse$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.t0 = type;\n          _context.next = _context.t0 === _dataActions.CRUD_UPDATE_SUCCESS ? 3 : _context.t0 === _dataActions.CRUD_CREATE_SUCCESS ? 13 : _context.t0 === _dataActions.CRUD_DELETE_SUCCESS ? 23 : _context.t0 === _dataActions.CRUD_GET_ONE_SUCCESS ? 33 : _context.t0 === _dataActions.CRUD_GET_ONE_FAILURE ? 38 : _context.t0 === _dataActions.CRUD_GET_LIST_FAILURE ? 48 : _context.t0 === _dataActions.CRUD_GET_MANY_FAILURE ? 48 : _context.t0 === _dataActions.CRUD_GET_MANY_REFERENCE_FAILURE ? 48 : _context.t0 === _dataActions.CRUD_CREATE_FAILURE ? 48 : _context.t0 === _dataActions.CRUD_UPDATE_FAILURE ? 48 : _context.t0 === _dataActions.CRUD_DELETE_FAILURE ? 48 : 53;\n          break;\n\n        case 3:\n          if (!requestPayload.redirectTo) {\n            _context.next = 9;\n            break;\n          }\n\n          _context.next = 6;\n          return (0, _effects.all)([(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.updated')), (0, _effects.put)((0, _reactRouterRedux.push)((0, _resolveRedirectTo2.default)(requestPayload.redirectTo, requestPayload.basePath, requestPayload.id)))]);\n\n        case 6:\n          _context.t1 = _context.sent;\n          _context.next = 12;\n          break;\n\n        case 9:\n          _context.next = 11;\n          return [(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.updated'))];\n\n        case 11:\n          _context.t1 = _context.sent;\n\n        case 12:\n          return _context.abrupt('return', _context.t1);\n\n        case 13:\n          if (!requestPayload.redirectTo) {\n            _context.next = 19;\n            break;\n          }\n\n          _context.next = 16;\n          return (0, _effects.all)([(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.created')), (0, _effects.put)((0, _reactRouterRedux.push)((0, _resolveRedirectTo2.default)(requestPayload.redirectTo, requestPayload.basePath, payload.data.id)))]);\n\n        case 16:\n          _context.t2 = _context.sent;\n          _context.next = 22;\n          break;\n\n        case 19:\n          _context.next = 21;\n          return (0, _effects.all)([(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.created')), (0, _effects.put)((0, _reduxForm.reset)('record-form'))]);\n\n        case 21:\n          _context.t2 = _context.sent;\n\n        case 22:\n          return _context.abrupt('return', _context.t2);\n\n        case 23:\n          if (!requestPayload.redirectTo) {\n            _context.next = 29;\n            break;\n          }\n\n          _context.next = 26;\n          return (0, _effects.all)([(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.deleted')), (0, _effects.put)((0, _reactRouterRedux.push)((0, _resolveRedirectTo2.default)(requestPayload.redirectTo, requestPayload.basePath, requestPayload.id)))]);\n\n        case 26:\n          _context.t3 = _context.sent;\n          _context.next = 32;\n          break;\n\n        case 29:\n          _context.next = 31;\n          return [(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.deleted'))];\n\n        case 31:\n          _context.t3 = _context.sent;\n\n        case 32:\n          return _context.abrupt('return', _context.t3);\n\n        case 33:\n          if (!(!('id' in payload.data) || payload.data.id != requestPayload.id)) {\n            _context.next = 37;\n            break;\n          }\n\n          _context.next = 36;\n          return (0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.bad_item', 'warning'));\n\n        case 36:\n          return _context.abrupt('return', _context.sent);\n\n        case 37:\n          return _context.abrupt('break', 56);\n\n        case 38:\n          if (!requestPayload.basePath) {\n            _context.next = 44;\n            break;\n          }\n\n          _context.next = 41;\n          return (0, _effects.all)([(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.item_doesnt_exist', 'warning')), (0, _effects.put)((0, _reactRouterRedux.push)(requestPayload.basePath))]);\n\n        case 41:\n          _context.t4 = _context.sent;\n          _context.next = 47;\n          break;\n\n        case 44:\n          _context.next = 46;\n          return (0, _effects.all)([]);\n\n        case 46:\n          _context.t4 = _context.sent;\n\n        case 47:\n          return _context.abrupt('return', _context.t4);\n\n        case 48:\n          console.error(error); // eslint-disable-line no-console\n\n          errorMessage = typeof error === 'string' ? error : error.message || 'aor.notification.http_error';\n          _context.next = 52;\n          return (0, _effects.put)((0, _notificationActions.showNotification)(errorMessage, 'warning'));\n\n        case 52:\n          return _context.abrupt('return', _context.sent);\n\n        case 53:\n          _context.next = 55;\n          return (0, _effects.all)([]);\n\n        case 55:\n          return _context.abrupt('return', _context.sent);\n\n        case 56:\n        case 'end':\n          return _context.stop();\n      }\n    }\n  }, _marked, this);\n}\n\nfunction _callee() {\n  return _regenerator2.default.wrap(function _callee$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return (0, _effects.takeEvery)(function (action) {\n            return action.meta && action.meta.fetchResponse;\n          }, handleResponse);\n\n        case 2:\n        case 'end':\n          return _context2.stop();\n      }\n    }\n  }, _marked2, this);\n}\n\nmodule.exports = exports['default'];","map":{"version":3,"sources":["C:/Users/m2bab/VM/rd2/frontend/node_modules/admin-on-rest/lib/sideEffect/saga/crudResponse.js"],"names":["Object","defineProperty","exports","value","_regenerator","require","_regenerator2","_interopRequireDefault","default","_callee","_effects","_reactRouterRedux","_reduxForm","_dataActions","_notificationActions","_resolveRedirectTo","_resolveRedirectTo2","obj","__esModule","_marked","mark","handleResponse","_marked2","_ref","type","requestPayload","error","payload","errorMessage","wrap","handleResponse$","_context","prev","next","t0","CRUD_UPDATE_SUCCESS","CRUD_CREATE_SUCCESS","CRUD_DELETE_SUCCESS","CRUD_GET_ONE_SUCCESS","CRUD_GET_ONE_FAILURE","CRUD_GET_LIST_FAILURE","CRUD_GET_MANY_FAILURE","CRUD_GET_MANY_REFERENCE_FAILURE","CRUD_CREATE_FAILURE","CRUD_UPDATE_FAILURE","CRUD_DELETE_FAILURE","redirectTo","all","put","showNotification","push","basePath","id","t1","sent","abrupt","data","t2","reset","t3","t4","console","message","stop","_callee$","_context2","takeEvery","action","meta","fetchResponse","module"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AACzCC,EAAAA,KAAK,EAAE;AADkC,CAA7C;;AAIA,IAAIC,YAAY,GAAGC,OAAO,CAAC,2BAAD,CAA1B;;AAEA,IAAIC,aAAa,GAAGC,sBAAsB,CAACH,YAAD,CAA1C;;AAEAF,OAAO,CAACM,OAAR,GAAkBC,OAAlB;;AAEA,IAAIC,QAAQ,GAAGL,OAAO,CAAC,oBAAD,CAAtB;;AAEA,IAAIM,iBAAiB,GAAGN,OAAO,CAAC,oBAAD,CAA/B;;AAEA,IAAIO,UAAU,GAAGP,OAAO,CAAC,YAAD,CAAxB;;AAEA,IAAIQ,YAAY,GAAGR,OAAO,CAAC,2BAAD,CAA1B;;AAEA,IAAIS,oBAAoB,GAAGT,OAAO,CAAC,mCAAD,CAAlC;;AAEA,IAAIU,kBAAkB,GAAGV,OAAO,CAAC,8BAAD,CAAhC;;AAEA,IAAIW,mBAAmB,GAAGT,sBAAsB,CAACQ,kBAAD,CAAhD;;AAEA,SAASR,sBAAT,CAAgCU,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AAAET,IAAAA,OAAO,EAAES;AAAX,GAArC;AAAwD;;AAE/F,IAAIE,OAAO,GAAG,aAAab,aAAa,CAACE,OAAd,CAAsBY,IAAtB,CAA2BC,cAA3B,CAA3B;AAAA,IACIC,QAAQ,GAAG,aAAahB,aAAa,CAACE,OAAd,CAAsBY,IAAtB,CAA2BX,OAA3B,CAD5B;AAGA;AACA;AACA;AACA;AACA;;;AACA,SAASY,cAAT,CAAwBE,IAAxB,EAA8B;AAC1B,MAAIC,IAAI,GAAGD,IAAI,CAACC,IAAhB;AAAA,MACIC,cAAc,GAAGF,IAAI,CAACE,cAD1B;AAAA,MAEIC,KAAK,GAAGH,IAAI,CAACG,KAFjB;AAAA,MAGIC,OAAO,GAAGJ,IAAI,CAACI,OAHnB;AAIA,MAAIC,YAAJ;AACA,SAAOtB,aAAa,CAACE,OAAd,CAAsBqB,IAAtB,CAA2B,SAASC,eAAT,CAAyBC,QAAzB,EAAmC;AACjE,WAAO,CAAP,EAAU;AACN,cAAQA,QAAQ,CAACC,IAAT,GAAgBD,QAAQ,CAACE,IAAjC;AACI,aAAK,CAAL;AACIF,UAAAA,QAAQ,CAACG,EAAT,GAAcV,IAAd;AACAO,UAAAA,QAAQ,CAACE,IAAT,GAAgBF,QAAQ,CAACG,EAAT,KAAgBrB,YAAY,CAACsB,mBAA7B,GAAmD,CAAnD,GAAuDJ,QAAQ,CAACG,EAAT,KAAgBrB,YAAY,CAACuB,mBAA7B,GAAmD,EAAnD,GAAwDL,QAAQ,CAACG,EAAT,KAAgBrB,YAAY,CAACwB,mBAA7B,GAAmD,EAAnD,GAAwDN,QAAQ,CAACG,EAAT,KAAgBrB,YAAY,CAACyB,oBAA7B,GAAoD,EAApD,GAAyDP,QAAQ,CAACG,EAAT,KAAgBrB,YAAY,CAAC0B,oBAA7B,GAAoD,EAApD,GAAyDR,QAAQ,CAACG,EAAT,KAAgBrB,YAAY,CAAC2B,qBAA7B,GAAqD,EAArD,GAA0DT,QAAQ,CAACG,EAAT,KAAgBrB,YAAY,CAAC4B,qBAA7B,GAAqD,EAArD,GAA0DV,QAAQ,CAACG,EAAT,KAAgBrB,YAAY,CAAC6B,+BAA7B,GAA+D,EAA/D,GAAoEX,QAAQ,CAACG,EAAT,KAAgBrB,YAAY,CAAC8B,mBAA7B,GAAmD,EAAnD,GAAwDZ,QAAQ,CAACG,EAAT,KAAgBrB,YAAY,CAAC+B,mBAA7B,GAAmD,EAAnD,GAAwDb,QAAQ,CAACG,EAAT,KAAgBrB,YAAY,CAACgC,mBAA7B,GAAmD,EAAnD,GAAwD,EAAzoB;AACA;;AAEJ,aAAK,CAAL;AACI,cAAI,CAACpB,cAAc,CAACqB,UAApB,EAAgC;AAC5Bf,YAAAA,QAAQ,CAACE,IAAT,GAAgB,CAAhB;AACA;AACH;;AAEDF,UAAAA,QAAQ,CAACE,IAAT,GAAgB,CAAhB;AACA,iBAAO,CAAC,GAAGvB,QAAQ,CAACqC,GAAb,EAAkB,CAAC,CAAC,GAAGrC,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGlC,oBAAoB,CAACmC,gBAAzB,EAA2C,0BAA3C,CAAlB,CAAD,EAA4F,CAAC,GAAGvC,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGrC,iBAAiB,CAACuC,IAAtB,EAA4B,CAAC,GAAGlC,mBAAmB,CAACR,OAAxB,EAAiCiB,cAAc,CAACqB,UAAhD,EAA4DrB,cAAc,CAAC0B,QAA3E,EAAqF1B,cAAc,CAAC2B,EAApG,CAA5B,CAAlB,CAA5F,CAAlB,CAAP;;AAEJ,aAAK,CAAL;AACIrB,UAAAA,QAAQ,CAACsB,EAAT,GAActB,QAAQ,CAACuB,IAAvB;AACAvB,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA;;AAEJ,aAAK,CAAL;AACIF,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA,iBAAO,CAAC,CAAC,GAAGvB,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGlC,oBAAoB,CAACmC,gBAAzB,EAA2C,0BAA3C,CAAlB,CAAD,CAAP;;AAEJ,aAAK,EAAL;AACIlB,UAAAA,QAAQ,CAACsB,EAAT,GAActB,QAAQ,CAACuB,IAAvB;;AAEJ,aAAK,EAAL;AACI,iBAAOvB,QAAQ,CAACwB,MAAT,CAAgB,QAAhB,EAA0BxB,QAAQ,CAACsB,EAAnC,CAAP;;AAEJ,aAAK,EAAL;AACI,cAAI,CAAC5B,cAAc,CAACqB,UAApB,EAAgC;AAC5Bf,YAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA;AACH;;AAEDF,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA,iBAAO,CAAC,GAAGvB,QAAQ,CAACqC,GAAb,EAAkB,CAAC,CAAC,GAAGrC,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGlC,oBAAoB,CAACmC,gBAAzB,EAA2C,0BAA3C,CAAlB,CAAD,EAA4F,CAAC,GAAGvC,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGrC,iBAAiB,CAACuC,IAAtB,EAA4B,CAAC,GAAGlC,mBAAmB,CAACR,OAAxB,EAAiCiB,cAAc,CAACqB,UAAhD,EAA4DrB,cAAc,CAAC0B,QAA3E,EAAqFxB,OAAO,CAAC6B,IAAR,CAAaJ,EAAlG,CAA5B,CAAlB,CAA5F,CAAlB,CAAP;;AAEJ,aAAK,EAAL;AACIrB,UAAAA,QAAQ,CAAC0B,EAAT,GAAc1B,QAAQ,CAACuB,IAAvB;AACAvB,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA;;AAEJ,aAAK,EAAL;AACIF,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA,iBAAO,CAAC,GAAGvB,QAAQ,CAACqC,GAAb,EAAkB,CAAC,CAAC,GAAGrC,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGlC,oBAAoB,CAACmC,gBAAzB,EAA2C,0BAA3C,CAAlB,CAAD,EAA4F,CAAC,GAAGvC,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGpC,UAAU,CAAC8C,KAAf,EAAsB,aAAtB,CAAlB,CAA5F,CAAlB,CAAP;;AAEJ,aAAK,EAAL;AACI3B,UAAAA,QAAQ,CAAC0B,EAAT,GAAc1B,QAAQ,CAACuB,IAAvB;;AAEJ,aAAK,EAAL;AACI,iBAAOvB,QAAQ,CAACwB,MAAT,CAAgB,QAAhB,EAA0BxB,QAAQ,CAAC0B,EAAnC,CAAP;;AAEJ,aAAK,EAAL;AACI,cAAI,CAAChC,cAAc,CAACqB,UAApB,EAAgC;AAC5Bf,YAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA;AACH;;AAEDF,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA,iBAAO,CAAC,GAAGvB,QAAQ,CAACqC,GAAb,EAAkB,CAAC,CAAC,GAAGrC,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGlC,oBAAoB,CAACmC,gBAAzB,EAA2C,0BAA3C,CAAlB,CAAD,EAA4F,CAAC,GAAGvC,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGrC,iBAAiB,CAACuC,IAAtB,EAA4B,CAAC,GAAGlC,mBAAmB,CAACR,OAAxB,EAAiCiB,cAAc,CAACqB,UAAhD,EAA4DrB,cAAc,CAAC0B,QAA3E,EAAqF1B,cAAc,CAAC2B,EAApG,CAA5B,CAAlB,CAA5F,CAAlB,CAAP;;AAEJ,aAAK,EAAL;AACIrB,UAAAA,QAAQ,CAAC4B,EAAT,GAAc5B,QAAQ,CAACuB,IAAvB;AACAvB,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA;;AAEJ,aAAK,EAAL;AACIF,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA,iBAAO,CAAC,CAAC,GAAGvB,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGlC,oBAAoB,CAACmC,gBAAzB,EAA2C,0BAA3C,CAAlB,CAAD,CAAP;;AAEJ,aAAK,EAAL;AACIlB,UAAAA,QAAQ,CAAC4B,EAAT,GAAc5B,QAAQ,CAACuB,IAAvB;;AAEJ,aAAK,EAAL;AACI,iBAAOvB,QAAQ,CAACwB,MAAT,CAAgB,QAAhB,EAA0BxB,QAAQ,CAAC4B,EAAnC,CAAP;;AAEJ,aAAK,EAAL;AACI,cAAI,EAAE,EAAE,QAAQhC,OAAO,CAAC6B,IAAlB,KAA2B7B,OAAO,CAAC6B,IAAR,CAAaJ,EAAb,IAAmB3B,cAAc,CAAC2B,EAA/D,CAAJ,EAAwE;AACpErB,YAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA;AACH;;AAEDF,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA,iBAAO,CAAC,GAAGvB,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGlC,oBAAoB,CAACmC,gBAAzB,EAA2C,2BAA3C,EAAwE,SAAxE,CAAlB,CAAP;;AAEJ,aAAK,EAAL;AACI,iBAAOlB,QAAQ,CAACwB,MAAT,CAAgB,QAAhB,EAA0BxB,QAAQ,CAACuB,IAAnC,CAAP;;AAEJ,aAAK,EAAL;AACI,iBAAOvB,QAAQ,CAACwB,MAAT,CAAgB,OAAhB,EAAyB,EAAzB,CAAP;;AAEJ,aAAK,EAAL;AACI,cAAI,CAAC9B,cAAc,CAAC0B,QAApB,EAA8B;AAC1BpB,YAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA;AACH;;AAEDF,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA,iBAAO,CAAC,GAAGvB,QAAQ,CAACqC,GAAb,EAAkB,CAAC,CAAC,GAAGrC,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGlC,oBAAoB,CAACmC,gBAAzB,EAA2C,oCAA3C,EAAiF,SAAjF,CAAlB,CAAD,EAAiH,CAAC,GAAGvC,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGrC,iBAAiB,CAACuC,IAAtB,EAA4BzB,cAAc,CAAC0B,QAA3C,CAAlB,CAAjH,CAAlB,CAAP;;AAEJ,aAAK,EAAL;AACIpB,UAAAA,QAAQ,CAAC6B,EAAT,GAAc7B,QAAQ,CAACuB,IAAvB;AACAvB,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA;;AAEJ,aAAK,EAAL;AACIF,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA,iBAAO,CAAC,GAAGvB,QAAQ,CAACqC,GAAb,EAAkB,EAAlB,CAAP;;AAEJ,aAAK,EAAL;AACIhB,UAAAA,QAAQ,CAAC6B,EAAT,GAAc7B,QAAQ,CAACuB,IAAvB;;AAEJ,aAAK,EAAL;AACI,iBAAOvB,QAAQ,CAACwB,MAAT,CAAgB,QAAhB,EAA0BxB,QAAQ,CAAC6B,EAAnC,CAAP;;AAEJ,aAAK,EAAL;AACIC,UAAAA,OAAO,CAACnC,KAAR,CAAcA,KAAd,EADJ,CAC0B;;AACtBE,UAAAA,YAAY,GAAG,OAAOF,KAAP,KAAiB,QAAjB,GAA4BA,KAA5B,GAAoCA,KAAK,CAACoC,OAAN,IAAiB,6BAApE;AACA/B,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA,iBAAO,CAAC,GAAGvB,QAAQ,CAACsC,GAAb,EAAkB,CAAC,GAAGlC,oBAAoB,CAACmC,gBAAzB,EAA2CrB,YAA3C,EAAyD,SAAzD,CAAlB,CAAP;;AAEJ,aAAK,EAAL;AACI,iBAAOG,QAAQ,CAACwB,MAAT,CAAgB,QAAhB,EAA0BxB,QAAQ,CAACuB,IAAnC,CAAP;;AAEJ,aAAK,EAAL;AACIvB,UAAAA,QAAQ,CAACE,IAAT,GAAgB,EAAhB;AACA,iBAAO,CAAC,GAAGvB,QAAQ,CAACqC,GAAb,EAAkB,EAAlB,CAAP;;AAEJ,aAAK,EAAL;AACI,iBAAOhB,QAAQ,CAACwB,MAAT,CAAgB,QAAhB,EAA0BxB,QAAQ,CAACuB,IAAnC,CAAP;;AAEJ,aAAK,EAAL;AACA,aAAK,KAAL;AACI,iBAAOvB,QAAQ,CAACgC,IAAT,EAAP;AAvIR;AAyIH;AACJ,GA5IM,EA4IJ5C,OA5II,EA4IK,IA5IL,CAAP;AA6IH;;AAED,SAASV,OAAT,GAAmB;AACf,SAAOH,aAAa,CAACE,OAAd,CAAsBqB,IAAtB,CAA2B,SAASmC,QAAT,CAAkBC,SAAlB,EAA6B;AAC3D,WAAO,CAAP,EAAU;AACN,cAAQA,SAAS,CAACjC,IAAV,GAAiBiC,SAAS,CAAChC,IAAnC;AACI,aAAK,CAAL;AACIgC,UAAAA,SAAS,CAAChC,IAAV,GAAiB,CAAjB;AACA,iBAAO,CAAC,GAAGvB,QAAQ,CAACwD,SAAb,EAAwB,UAAUC,MAAV,EAAkB;AAC7C,mBAAOA,MAAM,CAACC,IAAP,IAAeD,MAAM,CAACC,IAAP,CAAYC,aAAlC;AACH,WAFM,EAEJhD,cAFI,CAAP;;AAIJ,aAAK,CAAL;AACA,aAAK,KAAL;AACI,iBAAO4C,SAAS,CAACF,IAAV,EAAP;AATR;AAWH;AACJ,GAdM,EAcJzC,QAdI,EAcM,IAdN,CAAP;AAeH;;AACDgD,MAAM,CAACpE,OAAP,GAAiBA,OAAO,CAAC,SAAD,CAAxB","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nexports.default = _callee;\n\nvar _effects = require('redux-saga/effects');\n\nvar _reactRouterRedux = require('react-router-redux');\n\nvar _reduxForm = require('redux-form');\n\nvar _dataActions = require('../../actions/dataActions');\n\nvar _notificationActions = require('../../actions/notificationActions');\n\nvar _resolveRedirectTo = require('../../util/resolveRedirectTo');\n\nvar _resolveRedirectTo2 = _interopRequireDefault(_resolveRedirectTo);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _marked = /*#__PURE__*/_regenerator2.default.mark(handleResponse),\n    _marked2 = /*#__PURE__*/_regenerator2.default.mark(_callee);\n\n/**\n * Side effects for fetch responses\n *\n * Mostly redirects and notifications\n */\nfunction handleResponse(_ref) {\n    var type = _ref.type,\n        requestPayload = _ref.requestPayload,\n        error = _ref.error,\n        payload = _ref.payload;\n    var errorMessage;\n    return _regenerator2.default.wrap(function handleResponse$(_context) {\n        while (1) {\n            switch (_context.prev = _context.next) {\n                case 0:\n                    _context.t0 = type;\n                    _context.next = _context.t0 === _dataActions.CRUD_UPDATE_SUCCESS ? 3 : _context.t0 === _dataActions.CRUD_CREATE_SUCCESS ? 13 : _context.t0 === _dataActions.CRUD_DELETE_SUCCESS ? 23 : _context.t0 === _dataActions.CRUD_GET_ONE_SUCCESS ? 33 : _context.t0 === _dataActions.CRUD_GET_ONE_FAILURE ? 38 : _context.t0 === _dataActions.CRUD_GET_LIST_FAILURE ? 48 : _context.t0 === _dataActions.CRUD_GET_MANY_FAILURE ? 48 : _context.t0 === _dataActions.CRUD_GET_MANY_REFERENCE_FAILURE ? 48 : _context.t0 === _dataActions.CRUD_CREATE_FAILURE ? 48 : _context.t0 === _dataActions.CRUD_UPDATE_FAILURE ? 48 : _context.t0 === _dataActions.CRUD_DELETE_FAILURE ? 48 : 53;\n                    break;\n\n                case 3:\n                    if (!requestPayload.redirectTo) {\n                        _context.next = 9;\n                        break;\n                    }\n\n                    _context.next = 6;\n                    return (0, _effects.all)([(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.updated')), (0, _effects.put)((0, _reactRouterRedux.push)((0, _resolveRedirectTo2.default)(requestPayload.redirectTo, requestPayload.basePath, requestPayload.id)))]);\n\n                case 6:\n                    _context.t1 = _context.sent;\n                    _context.next = 12;\n                    break;\n\n                case 9:\n                    _context.next = 11;\n                    return [(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.updated'))];\n\n                case 11:\n                    _context.t1 = _context.sent;\n\n                case 12:\n                    return _context.abrupt('return', _context.t1);\n\n                case 13:\n                    if (!requestPayload.redirectTo) {\n                        _context.next = 19;\n                        break;\n                    }\n\n                    _context.next = 16;\n                    return (0, _effects.all)([(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.created')), (0, _effects.put)((0, _reactRouterRedux.push)((0, _resolveRedirectTo2.default)(requestPayload.redirectTo, requestPayload.basePath, payload.data.id)))]);\n\n                case 16:\n                    _context.t2 = _context.sent;\n                    _context.next = 22;\n                    break;\n\n                case 19:\n                    _context.next = 21;\n                    return (0, _effects.all)([(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.created')), (0, _effects.put)((0, _reduxForm.reset)('record-form'))]);\n\n                case 21:\n                    _context.t2 = _context.sent;\n\n                case 22:\n                    return _context.abrupt('return', _context.t2);\n\n                case 23:\n                    if (!requestPayload.redirectTo) {\n                        _context.next = 29;\n                        break;\n                    }\n\n                    _context.next = 26;\n                    return (0, _effects.all)([(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.deleted')), (0, _effects.put)((0, _reactRouterRedux.push)((0, _resolveRedirectTo2.default)(requestPayload.redirectTo, requestPayload.basePath, requestPayload.id)))]);\n\n                case 26:\n                    _context.t3 = _context.sent;\n                    _context.next = 32;\n                    break;\n\n                case 29:\n                    _context.next = 31;\n                    return [(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.deleted'))];\n\n                case 31:\n                    _context.t3 = _context.sent;\n\n                case 32:\n                    return _context.abrupt('return', _context.t3);\n\n                case 33:\n                    if (!(!('id' in payload.data) || payload.data.id != requestPayload.id)) {\n                        _context.next = 37;\n                        break;\n                    }\n\n                    _context.next = 36;\n                    return (0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.bad_item', 'warning'));\n\n                case 36:\n                    return _context.abrupt('return', _context.sent);\n\n                case 37:\n                    return _context.abrupt('break', 56);\n\n                case 38:\n                    if (!requestPayload.basePath) {\n                        _context.next = 44;\n                        break;\n                    }\n\n                    _context.next = 41;\n                    return (0, _effects.all)([(0, _effects.put)((0, _notificationActions.showNotification)('aor.notification.item_doesnt_exist', 'warning')), (0, _effects.put)((0, _reactRouterRedux.push)(requestPayload.basePath))]);\n\n                case 41:\n                    _context.t4 = _context.sent;\n                    _context.next = 47;\n                    break;\n\n                case 44:\n                    _context.next = 46;\n                    return (0, _effects.all)([]);\n\n                case 46:\n                    _context.t4 = _context.sent;\n\n                case 47:\n                    return _context.abrupt('return', _context.t4);\n\n                case 48:\n                    console.error(error); // eslint-disable-line no-console\n                    errorMessage = typeof error === 'string' ? error : error.message || 'aor.notification.http_error';\n                    _context.next = 52;\n                    return (0, _effects.put)((0, _notificationActions.showNotification)(errorMessage, 'warning'));\n\n                case 52:\n                    return _context.abrupt('return', _context.sent);\n\n                case 53:\n                    _context.next = 55;\n                    return (0, _effects.all)([]);\n\n                case 55:\n                    return _context.abrupt('return', _context.sent);\n\n                case 56:\n                case 'end':\n                    return _context.stop();\n            }\n        }\n    }, _marked, this);\n}\n\nfunction _callee() {\n    return _regenerator2.default.wrap(function _callee$(_context2) {\n        while (1) {\n            switch (_context2.prev = _context2.next) {\n                case 0:\n                    _context2.next = 2;\n                    return (0, _effects.takeEvery)(function (action) {\n                        return action.meta && action.meta.fetchResponse;\n                    }, handleResponse);\n\n                case 2:\n                case 'end':\n                    return _context2.stop();\n            }\n        }\n    }, _marked2, this);\n}\nmodule.exports = exports['default'];"]},"metadata":{},"sourceType":"script"}