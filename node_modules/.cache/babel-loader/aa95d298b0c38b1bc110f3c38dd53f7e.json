{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SwitchPermissionsComponent = undefined;\n\nvar _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _FormField = require('../mui/form/FormField');\n\nvar _FormField2 = _interopRequireDefault(_FormField);\n\nvar _getContext = require('recompose/getContext');\n\nvar _getContext2 = _interopRequireDefault(_getContext);\n\nvar _types = require('./types');\n\nvar _resolvePermissions = require('./resolvePermissions');\n\nvar _resolvePermissions2 = _interopRequireDefault(_resolvePermissions);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar SwitchPermissionsComponent = exports.SwitchPermissionsComponent = function (_Component) {\n  (0, _inherits3.default)(SwitchPermissionsComponent, _Component);\n\n  function SwitchPermissionsComponent() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    (0, _classCallCheck3.default)(this, SwitchPermissionsComponent);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, (_ref = SwitchPermissionsComponent.__proto__ || Object.getPrototypeOf(SwitchPermissionsComponent)).call.apply(_ref, [this].concat(args))), _this), _this.state = {\n      isNotFound: false,\n      match: undefined,\n      role: undefined\n    }, _this.renderSourceChild = function (child, props) {\n      return _react2.default.createElement('div', {\n        key: child.props.source,\n        style: child.props.style,\n        className: 'aor-input aor-input-' + child.props.source\n      }, _react2.default.createElement(_FormField2.default, (0, _extends3.default)({\n        input: child\n      }, props)));\n    }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n  }\n\n  (0, _createClass3.default)(SwitchPermissionsComponent, [{\n    key: 'componentWillMount',\n    value: function () {\n      var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {\n        var _props, authClient, children, record, resource, mappings, permissions, match;\n\n        return _regenerator2.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _props = this.props, authClient = _props.authClient, children = _props.children, record = _props.record, resource = _props.resource;\n                mappings = _react2.default.Children.map(children, function (child) {\n                  return child ? {\n                    permissions: child.props.value,\n                    resolve: child.props.resolve,\n                    view: child.props.children,\n                    exact: child.props.exact\n                  } : false;\n                }) || [];\n                _context.next = 4;\n                return authClient(_types.AUTH_GET_PERMISSIONS, {\n                  record: record,\n                  resource: resource\n                });\n\n              case 4:\n                permissions = _context.sent;\n                _context.next = 7;\n                return (0, _resolvePermissions2.default)({\n                  mappings: mappings.filter(function (m) {\n                    return m;\n                  }),\n                  permissions: permissions,\n                  record: record,\n                  resource: resource\n                });\n\n              case 7:\n                match = _context.sent;\n\n                if (match) {\n                  this.setState({\n                    match: match.view\n                  });\n                } else {\n                  this.setState({\n                    isNotFound: true,\n                    permissions: permissions\n                  });\n                }\n\n              case 9:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentWillMount() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return componentWillMount;\n    }()\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _state = this.state,\n          isNotFound = _state.isNotFound,\n          match = _state.match,\n          role = _state.role;\n      var _props2 = this.props,\n          authClient = _props2.authClient,\n          children = _props2.children,\n          notFound = _props2.notFound,\n          loading = _props2.loading,\n          props = (0, _objectWithoutProperties3.default)(_props2, ['authClient', 'children', 'notFound', 'loading']);\n\n      if (isNotFound) {\n        if (notFound) {\n          return (0, _react.createElement)(notFound, {\n            role: role\n          });\n        }\n\n        return null;\n      }\n\n      if (!match) {\n        return loading ? (0, _react.createElement)(loading) : null;\n      }\n\n      if (Array.isArray(match)) {\n        return _react2.default.createElement('div', null, _react2.default.Children.map(match, function (child) {\n          return child ? child.props.source ? _this2.renderSourceChild(child) : _react2.default.createElement(_FormField2.default, (0, _extends3.default)({\n            input: child\n          }, props)) : null;\n        }));\n      }\n\n      return match.props.source ? this.renderSourceChild(match) : _react2.default.createElement(_FormField2.default, (0, _extends3.default)({\n        input: match\n      }, props));\n    }\n  }]);\n  return SwitchPermissionsComponent;\n}(_react.Component);\n\nSwitchPermissionsComponent.propTypes = {\n  authClient: _propTypes2.default.func,\n  children: _propTypes2.default.node.isRequired,\n  notFound: _propTypes2.default.func,\n  loading: _propTypes2.default.func,\n  record: _propTypes2.default.object,\n  resource: _propTypes2.default.string\n};\nSwitchPermissionsComponent.defaultProps = {\n  notFound: null,\n  loading: null\n};\nexports.default = (0, _getContext2.default)({\n  authClient: _propTypes2.default.func\n})(SwitchPermissionsComponent);","map":{"version":3,"sources":["C:/Users/m2bab/VM/rd2/frontend/node_modules/admin-on-rest/lib/auth/SwitchPermissions.js"],"names":["Object","defineProperty","exports","value","SwitchPermissionsComponent","undefined","_objectWithoutProperties2","require","_objectWithoutProperties3","_interopRequireDefault","_regenerator","_regenerator2","_asyncToGenerator2","_asyncToGenerator3","_extends2","_extends3","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_react","_react2","_propTypes","_propTypes2","_FormField","_FormField2","_getContext","_getContext2","_types","_resolvePermissions","_resolvePermissions2","obj","__esModule","default","_Component","_ref","_temp","_this","_ret","_len","arguments","length","args","Array","_key","__proto__","getPrototypeOf","call","apply","concat","state","isNotFound","match","role","renderSourceChild","child","props","createElement","key","source","style","className","input","_ref2","mark","_callee","_props","authClient","children","record","resource","mappings","permissions","wrap","_callee$","_context","prev","next","Children","map","resolve","view","exact","AUTH_GET_PERMISSIONS","sent","filter","m","setState","stop","componentWillMount","render","_this2","_state","_props2","notFound","loading","isArray","Component","propTypes","func","node","isRequired","object","string","defaultProps"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AACzCC,EAAAA,KAAK,EAAE;AADkC,CAA7C;AAGAD,OAAO,CAACE,0BAAR,GAAqCC,SAArC;;AAEA,IAAIC,yBAAyB,GAAGC,OAAO,CAAC,+CAAD,CAAvC;;AAEA,IAAIC,yBAAyB,GAAGC,sBAAsB,CAACH,yBAAD,CAAtD;;AAEA,IAAII,YAAY,GAAGH,OAAO,CAAC,2BAAD,CAA1B;;AAEA,IAAII,aAAa,GAAGF,sBAAsB,CAACC,YAAD,CAA1C;;AAEA,IAAIE,kBAAkB,GAAGL,OAAO,CAAC,wCAAD,CAAhC;;AAEA,IAAIM,kBAAkB,GAAGJ,sBAAsB,CAACG,kBAAD,CAA/C;;AAEA,IAAIE,SAAS,GAAGP,OAAO,CAAC,+BAAD,CAAvB;;AAEA,IAAIQ,SAAS,GAAGN,sBAAsB,CAACK,SAAD,CAAtC;;AAEA,IAAIE,gBAAgB,GAAGT,OAAO,CAAC,sCAAD,CAA9B;;AAEA,IAAIU,gBAAgB,GAAGR,sBAAsB,CAACO,gBAAD,CAA7C;;AAEA,IAAIE,aAAa,GAAGX,OAAO,CAAC,mCAAD,CAA3B;;AAEA,IAAIY,aAAa,GAAGV,sBAAsB,CAACS,aAAD,CAA1C;;AAEA,IAAIE,2BAA2B,GAAGb,OAAO,CAAC,iDAAD,CAAzC;;AAEA,IAAIc,2BAA2B,GAAGZ,sBAAsB,CAACW,2BAAD,CAAxD;;AAEA,IAAIE,UAAU,GAAGf,OAAO,CAAC,gCAAD,CAAxB;;AAEA,IAAIgB,UAAU,GAAGd,sBAAsB,CAACa,UAAD,CAAvC;;AAEA,IAAIE,MAAM,GAAGjB,OAAO,CAAC,OAAD,CAApB;;AAEA,IAAIkB,OAAO,GAAGhB,sBAAsB,CAACe,MAAD,CAApC;;AAEA,IAAIE,UAAU,GAAGnB,OAAO,CAAC,YAAD,CAAxB;;AAEA,IAAIoB,WAAW,GAAGlB,sBAAsB,CAACiB,UAAD,CAAxC;;AAEA,IAAIE,UAAU,GAAGrB,OAAO,CAAC,uBAAD,CAAxB;;AAEA,IAAIsB,WAAW,GAAGpB,sBAAsB,CAACmB,UAAD,CAAxC;;AAEA,IAAIE,WAAW,GAAGvB,OAAO,CAAC,sBAAD,CAAzB;;AAEA,IAAIwB,YAAY,GAAGtB,sBAAsB,CAACqB,WAAD,CAAzC;;AAEA,IAAIE,MAAM,GAAGzB,OAAO,CAAC,SAAD,CAApB;;AAEA,IAAI0B,mBAAmB,GAAG1B,OAAO,CAAC,sBAAD,CAAjC;;AAEA,IAAI2B,oBAAoB,GAAGzB,sBAAsB,CAACwB,mBAAD,CAAjD;;AAEA,SAASxB,sBAAT,CAAgC0B,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AAAEE,IAAAA,OAAO,EAAEF;AAAX,GAArC;AAAwD;;AAE/F,IAAI/B,0BAA0B,GAAGF,OAAO,CAACE,0BAAR,GAAqC,UAAUkC,UAAV,EAAsB;AACxF,GAAC,GAAGf,UAAU,CAACc,OAAf,EAAwBjC,0BAAxB,EAAoDkC,UAApD;;AAEA,WAASlC,0BAAT,GAAsC;AAClC,QAAImC,IAAJ;;AAEA,QAAIC,KAAJ,EAAWC,KAAX,EAAkBC,IAAlB;;AAEA,KAAC,GAAGzB,gBAAgB,CAACoB,OAArB,EAA8B,IAA9B,EAAoCjC,0BAApC;;AAEA,SAAK,IAAIuC,IAAI,GAAGC,SAAS,CAACC,MAArB,EAA6BC,IAAI,GAAGC,KAAK,CAACJ,IAAD,CAAzC,EAAiDK,IAAI,GAAG,CAA7D,EAAgEA,IAAI,GAAGL,IAAvE,EAA6EK,IAAI,EAAjF,EAAqF;AACjFF,MAAAA,IAAI,CAACE,IAAD,CAAJ,GAAaJ,SAAS,CAACI,IAAD,CAAtB;AACH;;AAED,WAAON,IAAI,IAAIF,KAAK,IAAIC,KAAK,GAAG,CAAC,GAAGpB,2BAA2B,CAACgB,OAAhC,EAAyC,IAAzC,EAA+C,CAACE,IAAI,GAAGnC,0BAA0B,CAAC6C,SAA3B,IAAwCjD,MAAM,CAACkD,cAAP,CAAsB9C,0BAAtB,CAAhD,EAAmG+C,IAAnG,CAAwGC,KAAxG,CAA8Gb,IAA9G,EAAoH,CAAC,IAAD,EAAOc,MAAP,CAAcP,IAAd,CAApH,CAA/C,CAAR,EAAkML,KAAtM,CAAL,EAAmNA,KAAK,CAACa,KAAN,GAAc;AAC5OC,MAAAA,UAAU,EAAE,KADgO;AAE5OC,MAAAA,KAAK,EAAEnD,SAFqO;AAG5OoD,MAAAA,IAAI,EAAEpD;AAHsO,KAAjO,EAIZoC,KAAK,CAACiB,iBAAN,GAA0B,UAAUC,KAAV,EAAiBC,KAAjB,EAAwB;AACjD,aAAOnC,OAAO,CAACY,OAAR,CAAgBwB,aAAhB,CACH,KADG,EAEH;AACIC,QAAAA,GAAG,EAAEH,KAAK,CAACC,KAAN,CAAYG,MADrB;AAEIC,QAAAA,KAAK,EAAEL,KAAK,CAACC,KAAN,CAAYI,KAFvB;AAGIC,QAAAA,SAAS,EAAE,yBAAyBN,KAAK,CAACC,KAAN,CAAYG;AAHpD,OAFG,EAOHtC,OAAO,CAACY,OAAR,CAAgBwB,aAAhB,CAA8BhC,WAAW,CAACQ,OAA1C,EAAmD,CAAC,GAAGtB,SAAS,CAACsB,OAAd,EAAuB;AAAE6B,QAAAA,KAAK,EAAEP;AAAT,OAAvB,EAAyCC,KAAzC,CAAnD,CAPG,CAAP;AASH,KAdc,EAcZpB,KAdQ,CAAJ,EAcI,CAAC,GAAGnB,2BAA2B,CAACgB,OAAhC,EAAyCI,KAAzC,EAAgDC,IAAhD,CAdX;AAeH;;AAED,GAAC,GAAGvB,aAAa,CAACkB,OAAlB,EAA2BjC,0BAA3B,EAAuD,CAAC;AACpD0D,IAAAA,GAAG,EAAE,oBAD+C;AAEpD3D,IAAAA,KAAK,EAAE,YAAY;AACf,UAAIgE,KAAK,GAAG,CAAC,GAAGtD,kBAAkB,CAACwB,OAAvB,GAAiC,aAAa1B,aAAa,CAAC0B,OAAd,CAAsB+B,IAAtB,CAA2B,SAASC,OAAT,GAAmB;AACpG,YAAIC,MAAJ,EAAYC,UAAZ,EAAwBC,QAAxB,EAAkCC,MAAlC,EAA0CC,QAA1C,EAAoDC,QAApD,EAA8DC,WAA9D,EAA2EpB,KAA3E;;AAEA,eAAO7C,aAAa,CAAC0B,OAAd,CAAsBwC,IAAtB,CAA2B,SAASC,QAAT,CAAkBC,QAAlB,EAA4B;AAC1D,iBAAO,CAAP,EAAU;AACN,oBAAQA,QAAQ,CAACC,IAAT,GAAgBD,QAAQ,CAACE,IAAjC;AACI,mBAAK,CAAL;AACIX,gBAAAA,MAAM,GAAG,KAAKV,KAAd,EAAqBW,UAAU,GAAGD,MAAM,CAACC,UAAzC,EAAqDC,QAAQ,GAAGF,MAAM,CAACE,QAAvE,EAAiFC,MAAM,GAAGH,MAAM,CAACG,MAAjG,EAAyGC,QAAQ,GAAGJ,MAAM,CAACI,QAA3H;AACAC,gBAAAA,QAAQ,GAAGlD,OAAO,CAACY,OAAR,CAAgB6C,QAAhB,CAAyBC,GAAzB,CAA6BX,QAA7B,EAAuC,UAAUb,KAAV,EAAiB;AAC/D,yBAAOA,KAAK,GAAG;AACXiB,oBAAAA,WAAW,EAAEjB,KAAK,CAACC,KAAN,CAAYzD,KADd;AAEXiF,oBAAAA,OAAO,EAAEzB,KAAK,CAACC,KAAN,CAAYwB,OAFV;AAGXC,oBAAAA,IAAI,EAAE1B,KAAK,CAACC,KAAN,CAAYY,QAHP;AAIXc,oBAAAA,KAAK,EAAE3B,KAAK,CAACC,KAAN,CAAY0B;AAJR,mBAAH,GAKR,KALJ;AAMH,iBAPU,KAOL,EAPN;AAQAP,gBAAAA,QAAQ,CAACE,IAAT,GAAgB,CAAhB;AACA,uBAAOV,UAAU,CAACvC,MAAM,CAACuD,oBAAR,EAA8B;AAC3Cd,kBAAAA,MAAM,EAAEA,MADmC;AAE3CC,kBAAAA,QAAQ,EAAEA;AAFiC,iBAA9B,CAAjB;;AAKJ,mBAAK,CAAL;AACIE,gBAAAA,WAAW,GAAGG,QAAQ,CAACS,IAAvB;AACAT,gBAAAA,QAAQ,CAACE,IAAT,GAAgB,CAAhB;AACA,uBAAO,CAAC,GAAG/C,oBAAoB,CAACG,OAAzB,EAAkC;AACrCsC,kBAAAA,QAAQ,EAAEA,QAAQ,CAACc,MAAT,CAAgB,UAAUC,CAAV,EAAa;AACnC,2BAAOA,CAAP;AACH,mBAFS,CAD2B;AAIrCd,kBAAAA,WAAW,EAAEA,WAJwB;AAKrCH,kBAAAA,MAAM,EAAEA,MAL6B;AAMrCC,kBAAAA,QAAQ,EAAEA;AAN2B,iBAAlC,CAAP;;AASJ,mBAAK,CAAL;AACIlB,gBAAAA,KAAK,GAAGuB,QAAQ,CAACS,IAAjB;;AAGA,oBAAIhC,KAAJ,EAAW;AACP,uBAAKmC,QAAL,CAAc;AAAEnC,oBAAAA,KAAK,EAAEA,KAAK,CAAC6B;AAAf,mBAAd;AACH,iBAFD,MAEO;AACH,uBAAKM,QAAL,CAAc;AAAEpC,oBAAAA,UAAU,EAAE,IAAd;AAAoBqB,oBAAAA,WAAW,EAAEA;AAAjC,mBAAd;AACH;;AAEL,mBAAK,CAAL;AACA,mBAAK,KAAL;AACI,uBAAOG,QAAQ,CAACa,IAAT,EAAP;AAzCR;AA2CH;AACJ,SA9CM,EA8CJvB,OA9CI,EA8CK,IA9CL,CAAP;AA+CH,OAlDyD,CAA9C,CAAZ;;AAoDA,eAASwB,kBAAT,GAA8B;AAC1B,eAAO1B,KAAK,CAACf,KAAN,CAAY,IAAZ,EAAkBR,SAAlB,CAAP;AACH;;AAED,aAAOiD,kBAAP;AACH,KA1DM;AAF6C,GAAD,EA6DpD;AACC/B,IAAAA,GAAG,EAAE,QADN;AAEC3D,IAAAA,KAAK,EAAE,SAAS2F,MAAT,GAAkB;AACrB,UAAIC,MAAM,GAAG,IAAb;;AAEA,UAAIC,MAAM,GAAG,KAAK1C,KAAlB;AAAA,UACIC,UAAU,GAAGyC,MAAM,CAACzC,UADxB;AAAA,UAEIC,KAAK,GAAGwC,MAAM,CAACxC,KAFnB;AAAA,UAGIC,IAAI,GAAGuC,MAAM,CAACvC,IAHlB;AAIA,UAAIwC,OAAO,GAAG,KAAKrC,KAAnB;AAAA,UACIW,UAAU,GAAG0B,OAAO,CAAC1B,UADzB;AAAA,UAEIC,QAAQ,GAAGyB,OAAO,CAACzB,QAFvB;AAAA,UAGI0B,QAAQ,GAAGD,OAAO,CAACC,QAHvB;AAAA,UAIIC,OAAO,GAAGF,OAAO,CAACE,OAJtB;AAAA,UAKIvC,KAAK,GAAG,CAAC,GAAGpD,yBAAyB,CAAC6B,OAA9B,EAAuC4D,OAAvC,EAAgD,CAAC,YAAD,EAAe,UAAf,EAA2B,UAA3B,EAAuC,SAAvC,CAAhD,CALZ;;AAQA,UAAI1C,UAAJ,EAAgB;AACZ,YAAI2C,QAAJ,EAAc;AACV,iBAAO,CAAC,GAAG1E,MAAM,CAACqC,aAAX,EAA0BqC,QAA1B,EAAoC;AAAEzC,YAAAA,IAAI,EAAEA;AAAR,WAApC,CAAP;AACH;;AACD,eAAO,IAAP;AACH;;AAED,UAAI,CAACD,KAAL,EAAY;AACR,eAAO2C,OAAO,GAAG,CAAC,GAAG3E,MAAM,CAACqC,aAAX,EAA0BsC,OAA1B,CAAH,GAAwC,IAAtD;AACH;;AAED,UAAIpD,KAAK,CAACqD,OAAN,CAAc5C,KAAd,CAAJ,EAA0B;AACtB,eAAO/B,OAAO,CAACY,OAAR,CAAgBwB,aAAhB,CACH,KADG,EAEH,IAFG,EAGHpC,OAAO,CAACY,OAAR,CAAgB6C,QAAhB,CAAyBC,GAAzB,CAA6B3B,KAA7B,EAAoC,UAAUG,KAAV,EAAiB;AACjD,iBAAOA,KAAK,GAAGA,KAAK,CAACC,KAAN,CAAYG,MAAZ,GAAqBgC,MAAM,CAACrC,iBAAP,CAAyBC,KAAzB,CAArB,GAAuDlC,OAAO,CAACY,OAAR,CAAgBwB,aAAhB,CAA8BhC,WAAW,CAACQ,OAA1C,EAAmD,CAAC,GAAGtB,SAAS,CAACsB,OAAd,EAAuB;AAAE6B,YAAAA,KAAK,EAAEP;AAAT,WAAvB,EAAyCC,KAAzC,CAAnD,CAA1D,GAAgK,IAA5K;AACH,SAFD,CAHG,CAAP;AAOH;;AAED,aAAOJ,KAAK,CAACI,KAAN,CAAYG,MAAZ,GAAqB,KAAKL,iBAAL,CAAuBF,KAAvB,CAArB,GAAqD/B,OAAO,CAACY,OAAR,CAAgBwB,aAAhB,CAA8BhC,WAAW,CAACQ,OAA1C,EAAmD,CAAC,GAAGtB,SAAS,CAACsB,OAAd,EAAuB;AAAE6B,QAAAA,KAAK,EAAEV;AAAT,OAAvB,EAAyCI,KAAzC,CAAnD,CAA5D;AACH;AAvCF,GA7DoD,CAAvD;AAsGA,SAAOxD,0BAAP;AACH,CAtIqE,CAsIpEoB,MAAM,CAAC6E,SAtI6D,CAAtE;;AAwIAjG,0BAA0B,CAACkG,SAA3B,GAAuC;AACnC/B,EAAAA,UAAU,EAAE5C,WAAW,CAACU,OAAZ,CAAoBkE,IADG;AAEnC/B,EAAAA,QAAQ,EAAE7C,WAAW,CAACU,OAAZ,CAAoBmE,IAApB,CAAyBC,UAFA;AAGnCP,EAAAA,QAAQ,EAAEvE,WAAW,CAACU,OAAZ,CAAoBkE,IAHK;AAInCJ,EAAAA,OAAO,EAAExE,WAAW,CAACU,OAAZ,CAAoBkE,IAJM;AAKnC9B,EAAAA,MAAM,EAAE9C,WAAW,CAACU,OAAZ,CAAoBqE,MALO;AAMnChC,EAAAA,QAAQ,EAAE/C,WAAW,CAACU,OAAZ,CAAoBsE;AANK,CAAvC;AAQAvG,0BAA0B,CAACwG,YAA3B,GAA0C;AACtCV,EAAAA,QAAQ,EAAE,IAD4B;AAEtCC,EAAAA,OAAO,EAAE;AAF6B,CAA1C;AAIAjG,OAAO,CAACmC,OAAR,GAAkB,CAAC,GAAGN,YAAY,CAACM,OAAjB,EAA0B;AACxCkC,EAAAA,UAAU,EAAE5C,WAAW,CAACU,OAAZ,CAAoBkE;AADQ,CAA1B,EAEfnG,0BAFe,CAAlB","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.SwitchPermissionsComponent = undefined;\n\nvar _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _FormField = require('../mui/form/FormField');\n\nvar _FormField2 = _interopRequireDefault(_FormField);\n\nvar _getContext = require('recompose/getContext');\n\nvar _getContext2 = _interopRequireDefault(_getContext);\n\nvar _types = require('./types');\n\nvar _resolvePermissions = require('./resolvePermissions');\n\nvar _resolvePermissions2 = _interopRequireDefault(_resolvePermissions);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar SwitchPermissionsComponent = exports.SwitchPermissionsComponent = function (_Component) {\n    (0, _inherits3.default)(SwitchPermissionsComponent, _Component);\n\n    function SwitchPermissionsComponent() {\n        var _ref;\n\n        var _temp, _this, _ret;\n\n        (0, _classCallCheck3.default)(this, SwitchPermissionsComponent);\n\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, (_ref = SwitchPermissionsComponent.__proto__ || Object.getPrototypeOf(SwitchPermissionsComponent)).call.apply(_ref, [this].concat(args))), _this), _this.state = {\n            isNotFound: false,\n            match: undefined,\n            role: undefined\n        }, _this.renderSourceChild = function (child, props) {\n            return _react2.default.createElement(\n                'div',\n                {\n                    key: child.props.source,\n                    style: child.props.style,\n                    className: 'aor-input aor-input-' + child.props.source\n                },\n                _react2.default.createElement(_FormField2.default, (0, _extends3.default)({ input: child }, props))\n            );\n        }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n    }\n\n    (0, _createClass3.default)(SwitchPermissionsComponent, [{\n        key: 'componentWillMount',\n        value: function () {\n            var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {\n                var _props, authClient, children, record, resource, mappings, permissions, match;\n\n                return _regenerator2.default.wrap(function _callee$(_context) {\n                    while (1) {\n                        switch (_context.prev = _context.next) {\n                            case 0:\n                                _props = this.props, authClient = _props.authClient, children = _props.children, record = _props.record, resource = _props.resource;\n                                mappings = _react2.default.Children.map(children, function (child) {\n                                    return child ? {\n                                        permissions: child.props.value,\n                                        resolve: child.props.resolve,\n                                        view: child.props.children,\n                                        exact: child.props.exact\n                                    } : false;\n                                }) || [];\n                                _context.next = 4;\n                                return authClient(_types.AUTH_GET_PERMISSIONS, {\n                                    record: record,\n                                    resource: resource\n                                });\n\n                            case 4:\n                                permissions = _context.sent;\n                                _context.next = 7;\n                                return (0, _resolvePermissions2.default)({\n                                    mappings: mappings.filter(function (m) {\n                                        return m;\n                                    }),\n                                    permissions: permissions,\n                                    record: record,\n                                    resource: resource\n                                });\n\n                            case 7:\n                                match = _context.sent;\n\n\n                                if (match) {\n                                    this.setState({ match: match.view });\n                                } else {\n                                    this.setState({ isNotFound: true, permissions: permissions });\n                                }\n\n                            case 9:\n                            case 'end':\n                                return _context.stop();\n                        }\n                    }\n                }, _callee, this);\n            }));\n\n            function componentWillMount() {\n                return _ref2.apply(this, arguments);\n            }\n\n            return componentWillMount;\n        }()\n    }, {\n        key: 'render',\n        value: function render() {\n            var _this2 = this;\n\n            var _state = this.state,\n                isNotFound = _state.isNotFound,\n                match = _state.match,\n                role = _state.role;\n            var _props2 = this.props,\n                authClient = _props2.authClient,\n                children = _props2.children,\n                notFound = _props2.notFound,\n                loading = _props2.loading,\n                props = (0, _objectWithoutProperties3.default)(_props2, ['authClient', 'children', 'notFound', 'loading']);\n\n\n            if (isNotFound) {\n                if (notFound) {\n                    return (0, _react.createElement)(notFound, { role: role });\n                }\n                return null;\n            }\n\n            if (!match) {\n                return loading ? (0, _react.createElement)(loading) : null;\n            }\n\n            if (Array.isArray(match)) {\n                return _react2.default.createElement(\n                    'div',\n                    null,\n                    _react2.default.Children.map(match, function (child) {\n                        return child ? child.props.source ? _this2.renderSourceChild(child) : _react2.default.createElement(_FormField2.default, (0, _extends3.default)({ input: child }, props)) : null;\n                    })\n                );\n            }\n\n            return match.props.source ? this.renderSourceChild(match) : _react2.default.createElement(_FormField2.default, (0, _extends3.default)({ input: match }, props));\n        }\n    }]);\n    return SwitchPermissionsComponent;\n}(_react.Component);\n\nSwitchPermissionsComponent.propTypes = {\n    authClient: _propTypes2.default.func,\n    children: _propTypes2.default.node.isRequired,\n    notFound: _propTypes2.default.func,\n    loading: _propTypes2.default.func,\n    record: _propTypes2.default.object,\n    resource: _propTypes2.default.string\n};\nSwitchPermissionsComponent.defaultProps = {\n    notFound: null,\n    loading: null\n};\nexports.default = (0, _getContext2.default)({\n    authClient: _propTypes2.default.func\n})(SwitchPermissionsComponent);"]},"metadata":{},"sourceType":"script"}