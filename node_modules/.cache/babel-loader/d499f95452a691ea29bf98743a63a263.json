{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReferenceArrayInput = exports.getDataStatus = exports.getSelectedReferencesStatus = exports.REFERENCES_STATUS_EMPTY = exports.REFERENCES_STATUS_INCOMPLETE = exports.REFERENCES_STATUS_READY = undefined;\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactRedux = require('react-redux');\n\nvar _lodash = require('lodash.debounce');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _dataActions = require('../../actions/dataActions');\n\nvar _possibleValues = require('../../reducer/admin/references/possibleValues');\n\nvar _ReferenceLoadingProgress = require('./ReferenceLoadingProgress');\n\nvar _ReferenceLoadingProgress2 = _interopRequireDefault(_ReferenceLoadingProgress);\n\nvar _ReferenceError = require('./ReferenceError');\n\nvar _ReferenceError2 = _interopRequireDefault(_ReferenceError);\n\nvar _translate = require('../../i18n/translate');\n\nvar _translate2 = _interopRequireDefault(_translate);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar referenceSource = function referenceSource(resource, source) {\n  return resource + '@' + source;\n};\n\nvar REFERENCES_STATUS_READY = exports.REFERENCES_STATUS_READY = 'REFERENCES_STATUS_READY';\nvar REFERENCES_STATUS_INCOMPLETE = exports.REFERENCES_STATUS_INCOMPLETE = 'REFERENCES_STATUS_INCOMPLETE';\nvar REFERENCES_STATUS_EMPTY = exports.REFERENCES_STATUS_EMPTY = 'REFERENCES_STATUS_EMPTY';\n\nvar getSelectedReferencesStatus = exports.getSelectedReferencesStatus = function getSelectedReferencesStatus(input, referenceRecords) {\n  return !input.value || input.value.length === referenceRecords.length ? REFERENCES_STATUS_READY : referenceRecords.length > 0 ? REFERENCES_STATUS_INCOMPLETE : REFERENCES_STATUS_EMPTY;\n};\n\nvar getDataStatus = exports.getDataStatus = function getDataStatus(_ref) {\n  var input = _ref.input,\n      matchingReferences = _ref.matchingReferences,\n      referenceRecords = _ref.referenceRecords,\n      translate = _ref.translate; // selectedReferencesData can be \"empty\" (no data was found for references from input.value)\n  // or \"incomplete\" (Not all of the reference data was found)\n  // or \"ready\" (all references data was found or there is no references from input.value)\n\n  var selectedReferencesData = getSelectedReferencesStatus(input, referenceRecords);\n  var matchingReferencesError = matchingReferences && matchingReferences.error ? translate(matchingReferences.error, {\n    _: matchingReferences.error\n  }) : null;\n  return {\n    waiting: !matchingReferences && input.value && selectedReferencesData === REFERENCES_STATUS_EMPTY || !matchingReferences && !input.value,\n    error: matchingReferencesError && (!input.value || input.value && selectedReferencesData === REFERENCES_STATUS_EMPTY) ? translate('aor.input.references.all_missing', {\n      _: 'aor.input.references.all_missing'\n    }) : null,\n    warning: matchingReferencesError || input.value && selectedReferencesData !== REFERENCES_STATUS_READY ? matchingReferencesError || translate('aor.input.references.many_missing', {\n      _: 'aor.input.references.many_missing'\n    }) : null,\n    choices: Array.isArray(matchingReferences) ? matchingReferences : referenceRecords\n  };\n};\n/**\n * An Input component for fields containing a list of references to another resource.\n * Useful for 'hasMany' relationship.\n *\n * @example\n * The post object has many tags, so the post resource looks like:\n * {\n *    id: 1234,\n *    tag_ids: [ \"1\", \"23\", \"4\" ]\n * }\n *\n * ReferenceArrayInput component fetches the current resources (using the\n * `CRUD_GET_MANY` REST method) as well as possible resources (using the\n * `CRUD_GET_MATCHING` REST method) in the reference endpoint. It then\n * delegates rendering to a subcomponent, to which it passes the possible\n * choices as the `choices` attribute.\n *\n * Use it with a selector component as child, like `<SelectArrayInput>`\n * or <CheckboxGroupInput>.\n *\n * @example\n * export const PostEdit = (props) => (\n *     <Edit {...props}>\n *         <SimpleForm>\n *             <ReferenceArrayInput source=\"tag_ids\" reference=\"tags\">\n *                 <SelectArrayInput optionText=\"name\" />\n *             </ReferenceArrayInput>\n *         </SimpleForm>\n *     </Edit>\n * );\n *\n * By default, restricts the possible values to 25. You can extend this limit\n * by setting the `perPage` prop.\n *\n * @example\n * <ReferenceArrayInput\n *      source=\"tag_ids\"\n *      reference=\"tags\"\n *      perPage={100}>\n *     <SelectArrayInput optionText=\"name\" />\n * </ReferenceArrayInput>\n *\n * By default, orders the possible values by id desc. You can change this order\n * by setting the `sort` prop (an object with `field` and `order` properties).\n *\n * @example\n * <ReferenceArrayInput\n *      source=\"tag_ids\"\n *      reference=\"tags\"\n *      sort={{ field: 'name', order: 'ASC' }}>\n *     <SelectArrayInput optionText=\"name\" />\n * </ReferenceArrayInput>\n *\n * Also, you can filter the query used to populate the possible values. Use the\n * `filter` prop for that.\n *\n * @example\n * <ReferenceArrayInput\n *      source=\"tag_ids\"\n *      reference=\"tags\"\n *      filter={{ is_public: true }}>\n *     <SelectArrayInput optionText=\"name\" />\n * </ReferenceArrayInput>\n *\n * The enclosed component may filter results. ReferenceArrayInput passes a\n * `setFilter` function as prop to its child component. It uses the value to\n * create a filter for the query - by default { q: [searchText] }. You can\n * customize the mapping searchText => searchQuery by setting a custom\n * `filterToQuery` function prop:\n *\n * @example\n * <ReferenceArrayInput\n *      source=\"tag_ids\"\n *      reference=\"tags\"\n *      filterToQuery={searchText => ({ name: searchText })}>\n *     <SelectArrayInput optionText=\"name\" />\n * </ReferenceArrayInput>\n */\n\n\nvar ReferenceArrayInput = exports.ReferenceArrayInput = function (_Component) {\n  (0, _inherits3.default)(ReferenceArrayInput, _Component);\n\n  function ReferenceArrayInput(props) {\n    (0, _classCallCheck3.default)(this, ReferenceArrayInput);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (ReferenceArrayInput.__proto__ || Object.getPrototypeOf(ReferenceArrayInput)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var perPage = props.perPage,\n        sort = props.sort,\n        filter = props.filter; // stored as a property rather than state because we don't want redraw of async updates\n\n    _this.params = {\n      pagination: {\n        page: 1,\n        perPage: perPage\n      },\n      sort: sort,\n      filter: filter\n    };\n    _this.debouncedSetFilter = (0, _lodash2.default)(_this.setFilter.bind(_this), 500);\n    return _this;\n  }\n\n  (0, _createClass3.default)(ReferenceArrayInput, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.fetchReferenceAndOptions();\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (this.props.record.id !== nextProps.record.id) {\n        this.fetchReferenceAndOptions(nextProps);\n      }\n    }\n  }, {\n    key: 'fetchReferenceAndOptions',\n    value: function fetchReferenceAndOptions() {\n      var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props,\n          input = _ref2.input,\n          reference = _ref2.reference,\n          source = _ref2.source,\n          resource = _ref2.resource;\n\n      var _params = this.params,\n          pagination = _params.pagination,\n          sort = _params.sort,\n          filter = _params.filter;\n      var ids = input.value;\n\n      if (ids) {\n        if (!Array.isArray(ids)) {\n          throw Error('The value of ReferenceArrayInput should be an array');\n        }\n\n        this.props.crudGetMany(reference, ids);\n      }\n\n      this.props.crudGetMatching(reference, referenceSource(resource, source), pagination, sort, filter);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          input = _props.input,\n          resource = _props.resource,\n          label = _props.label,\n          source = _props.source,\n          allowEmpty = _props.allowEmpty,\n          matchingReferences = _props.matchingReferences,\n          basePath = _props.basePath,\n          onChange = _props.onChange,\n          children = _props.children,\n          meta = _props.meta,\n          translate = _props.translate,\n          referenceRecords = _props.referenceRecords;\n\n      if (_react2.default.Children.count(children) !== 1) {\n        throw new Error('<ReferenceArrayInput> only accepts a single child (like <Datagrid>)');\n      }\n\n      var translatedLabel = translate(label || 'resources.' + resource + '.fields.' + source);\n      var dataStatus = getDataStatus({\n        input: input,\n        matchingReferences: matchingReferences,\n        referenceRecords: referenceRecords,\n        translate: translate\n      });\n\n      if (dataStatus.waiting) {\n        return _react2.default.createElement(_ReferenceLoadingProgress2.default, {\n          label: translatedLabel\n        });\n      }\n\n      if (dataStatus.error) {\n        return _react2.default.createElement(_ReferenceError2.default, {\n          label: translatedLabel,\n          error: translate('aor.input.references.all_missing', {\n            _: 'aor.input.references.all_missing'\n          })\n        });\n      }\n\n      return _react2.default.cloneElement(children, {\n        allowEmpty: allowEmpty,\n        input: input,\n        label: translatedLabel,\n        resource: resource,\n        meta: dataStatus.warning ? (0, _extends3.default)({}, meta, {\n          error: dataStatus.warning,\n          touched: true\n        }) : meta,\n        source: source,\n        choices: dataStatus.choices,\n        basePath: basePath,\n        onChange: onChange,\n        setFilter: this.debouncedSetFilter,\n        setPagination: this.setPagination,\n        setSort: this.setSort,\n        translateChoice: false\n      });\n    }\n  }]);\n  return ReferenceArrayInput;\n}(_react.Component);\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.setFilter = function (filter) {\n    if (filter !== _this2.params.filter) {\n      _this2.params.filter = _this2.props.filterToQuery(filter);\n\n      _this2.fetchReferenceAndOptions();\n    }\n  };\n\n  this.setPagination = function (pagination) {\n    if (pagination !== _this2.param.pagination) {\n      _this2.param.pagination = pagination;\n\n      _this2.fetchReferenceAndOptions();\n    }\n  };\n\n  this.setSort = function (sort) {\n    if (sort !== _this2.params.sort) {\n      _this2.params.sort = sort;\n\n      _this2.fetchReferenceAndOptions();\n    }\n  };\n};\n\nReferenceArrayInput.propTypes = {\n  addField: _propTypes2.default.bool.isRequired,\n  allowEmpty: _propTypes2.default.bool.isRequired,\n  basePath: _propTypes2.default.string,\n  children: _propTypes2.default.element.isRequired,\n  crudGetMatching: _propTypes2.default.func.isRequired,\n  crudGetMany: _propTypes2.default.func.isRequired,\n  filter: _propTypes2.default.object,\n  filterToQuery: _propTypes2.default.func.isRequired,\n  input: _propTypes2.default.object.isRequired,\n  label: _propTypes2.default.string,\n  matchingReferences: _propTypes2.default.array,\n  meta: _propTypes2.default.object,\n  onChange: _propTypes2.default.func,\n  perPage: _propTypes2.default.number,\n  reference: _propTypes2.default.string.isRequired,\n  referenceRecords: _propTypes2.default.array,\n  resource: _propTypes2.default.string.isRequired,\n  sort: _propTypes2.default.shape({\n    field: _propTypes2.default.string,\n    order: _propTypes2.default.oneOf(['ASC', 'DESC'])\n  }),\n  source: _propTypes2.default.string,\n  translate: _propTypes2.default.func.isRequired\n};\nReferenceArrayInput.defaultProps = {\n  allowEmpty: false,\n  filter: {},\n  filterToQuery: function filterToQuery(searchText) {\n    return {\n      q: searchText\n    };\n  },\n  matchingReferences: null,\n  perPage: 25,\n  referenceRecords: [],\n  sort: {\n    field: 'id',\n    order: 'DESC'\n  }\n};\n\nfunction mapStateToProps(state, props) {\n  var referenceIds = props.input.value || [];\n  var data = state.admin.resources[props.reference].data;\n  return {\n    matchingReferences: (0, _possibleValues.getPossibleReferences)(state, referenceSource(props.resource, props.source), props.reference, referenceIds),\n    referenceRecords: referenceIds.reduce(function (references, referenceId) {\n      if (data[referenceId]) {\n        references.push(data[referenceId]);\n      }\n\n      return references;\n    }, [])\n  };\n}\n\nvar ConnectedReferenceArrayInput = (0, _reactRedux.connect)(mapStateToProps, {\n  crudGetMany: _dataActions.crudGetMany,\n  crudGetMatching: _dataActions.crudGetMatching\n})((0, _translate2.default)(ReferenceArrayInput));\nConnectedReferenceArrayInput.defaultProps = {\n  addField: true\n};\nexports.default = ConnectedReferenceArrayInput;","map":{"version":3,"sources":["C:/Users/m2bab/VM/rd2/frontend/node_modules/admin-on-rest/lib/mui/input/ReferenceArrayInput.js"],"names":["Object","defineProperty","exports","value","ReferenceArrayInput","getDataStatus","getSelectedReferencesStatus","REFERENCES_STATUS_EMPTY","REFERENCES_STATUS_INCOMPLETE","REFERENCES_STATUS_READY","undefined","_extends2","require","_extends3","_interopRequireDefault","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_react","_react2","_propTypes","_propTypes2","_reactRedux","_lodash","_lodash2","_dataActions","_possibleValues","_ReferenceLoadingProgress","_ReferenceLoadingProgress2","_ReferenceError","_ReferenceError2","_translate","_translate2","obj","__esModule","default","referenceSource","resource","source","input","referenceRecords","length","_ref","matchingReferences","translate","selectedReferencesData","matchingReferencesError","error","_","waiting","warning","choices","Array","isArray","_Component","props","_this","__proto__","getPrototypeOf","call","_initialiseProps","perPage","sort","filter","params","pagination","page","debouncedSetFilter","setFilter","bind","key","componentDidMount","fetchReferenceAndOptions","componentWillReceiveProps","nextProps","record","id","_ref2","arguments","reference","_params","ids","Error","crudGetMany","crudGetMatching","render","_props","label","allowEmpty","basePath","onChange","children","meta","Children","count","translatedLabel","dataStatus","createElement","cloneElement","touched","setPagination","setSort","translateChoice","Component","_this2","filterToQuery","param","propTypes","addField","bool","isRequired","string","element","func","object","array","number","shape","field","order","oneOf","defaultProps","searchText","q","mapStateToProps","state","referenceIds","data","admin","resources","getPossibleReferences","reduce","references","referenceId","push","ConnectedReferenceArrayInput","connect"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ReferenceArrayInput = exports.getDataStatus = exports.getSelectedReferencesStatus = exports.REFERENCES_STATUS_EMPTY = exports.REFERENCES_STATUS_INCOMPLETE = exports.REFERENCES_STATUS_READY = undefined;\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactRedux = require('react-redux');\n\nvar _lodash = require('lodash.debounce');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _dataActions = require('../../actions/dataActions');\n\nvar _possibleValues = require('../../reducer/admin/references/possibleValues');\n\nvar _ReferenceLoadingProgress = require('./ReferenceLoadingProgress');\n\nvar _ReferenceLoadingProgress2 = _interopRequireDefault(_ReferenceLoadingProgress);\n\nvar _ReferenceError = require('./ReferenceError');\n\nvar _ReferenceError2 = _interopRequireDefault(_ReferenceError);\n\nvar _translate = require('../../i18n/translate');\n\nvar _translate2 = _interopRequireDefault(_translate);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar referenceSource = function referenceSource(resource, source) {\n    return resource + '@' + source;\n};\n\nvar REFERENCES_STATUS_READY = exports.REFERENCES_STATUS_READY = 'REFERENCES_STATUS_READY';\nvar REFERENCES_STATUS_INCOMPLETE = exports.REFERENCES_STATUS_INCOMPLETE = 'REFERENCES_STATUS_INCOMPLETE';\nvar REFERENCES_STATUS_EMPTY = exports.REFERENCES_STATUS_EMPTY = 'REFERENCES_STATUS_EMPTY';\nvar getSelectedReferencesStatus = exports.getSelectedReferencesStatus = function getSelectedReferencesStatus(input, referenceRecords) {\n    return !input.value || input.value.length === referenceRecords.length ? REFERENCES_STATUS_READY : referenceRecords.length > 0 ? REFERENCES_STATUS_INCOMPLETE : REFERENCES_STATUS_EMPTY;\n};\n\nvar getDataStatus = exports.getDataStatus = function getDataStatus(_ref) {\n    var input = _ref.input,\n        matchingReferences = _ref.matchingReferences,\n        referenceRecords = _ref.referenceRecords,\n        translate = _ref.translate;\n\n    // selectedReferencesData can be \"empty\" (no data was found for references from input.value)\n    // or \"incomplete\" (Not all of the reference data was found)\n    // or \"ready\" (all references data was found or there is no references from input.value)\n    var selectedReferencesData = getSelectedReferencesStatus(input, referenceRecords);\n\n    var matchingReferencesError = matchingReferences && matchingReferences.error ? translate(matchingReferences.error, {\n        _: matchingReferences.error\n    }) : null;\n\n    return {\n        waiting: !matchingReferences && input.value && selectedReferencesData === REFERENCES_STATUS_EMPTY || !matchingReferences && !input.value,\n        error: matchingReferencesError && (!input.value || input.value && selectedReferencesData === REFERENCES_STATUS_EMPTY) ? translate('aor.input.references.all_missing', {\n            _: 'aor.input.references.all_missing'\n        }) : null,\n        warning: matchingReferencesError || input.value && selectedReferencesData !== REFERENCES_STATUS_READY ? matchingReferencesError || translate('aor.input.references.many_missing', {\n            _: 'aor.input.references.many_missing'\n        }) : null,\n        choices: Array.isArray(matchingReferences) ? matchingReferences : referenceRecords\n    };\n};\n\n/**\n * An Input component for fields containing a list of references to another resource.\n * Useful for 'hasMany' relationship.\n *\n * @example\n * The post object has many tags, so the post resource looks like:\n * {\n *    id: 1234,\n *    tag_ids: [ \"1\", \"23\", \"4\" ]\n * }\n *\n * ReferenceArrayInput component fetches the current resources (using the\n * `CRUD_GET_MANY` REST method) as well as possible resources (using the\n * `CRUD_GET_MATCHING` REST method) in the reference endpoint. It then\n * delegates rendering to a subcomponent, to which it passes the possible\n * choices as the `choices` attribute.\n *\n * Use it with a selector component as child, like `<SelectArrayInput>`\n * or <CheckboxGroupInput>.\n *\n * @example\n * export const PostEdit = (props) => (\n *     <Edit {...props}>\n *         <SimpleForm>\n *             <ReferenceArrayInput source=\"tag_ids\" reference=\"tags\">\n *                 <SelectArrayInput optionText=\"name\" />\n *             </ReferenceArrayInput>\n *         </SimpleForm>\n *     </Edit>\n * );\n *\n * By default, restricts the possible values to 25. You can extend this limit\n * by setting the `perPage` prop.\n *\n * @example\n * <ReferenceArrayInput\n *      source=\"tag_ids\"\n *      reference=\"tags\"\n *      perPage={100}>\n *     <SelectArrayInput optionText=\"name\" />\n * </ReferenceArrayInput>\n *\n * By default, orders the possible values by id desc. You can change this order\n * by setting the `sort` prop (an object with `field` and `order` properties).\n *\n * @example\n * <ReferenceArrayInput\n *      source=\"tag_ids\"\n *      reference=\"tags\"\n *      sort={{ field: 'name', order: 'ASC' }}>\n *     <SelectArrayInput optionText=\"name\" />\n * </ReferenceArrayInput>\n *\n * Also, you can filter the query used to populate the possible values. Use the\n * `filter` prop for that.\n *\n * @example\n * <ReferenceArrayInput\n *      source=\"tag_ids\"\n *      reference=\"tags\"\n *      filter={{ is_public: true }}>\n *     <SelectArrayInput optionText=\"name\" />\n * </ReferenceArrayInput>\n *\n * The enclosed component may filter results. ReferenceArrayInput passes a\n * `setFilter` function as prop to its child component. It uses the value to\n * create a filter for the query - by default { q: [searchText] }. You can\n * customize the mapping searchText => searchQuery by setting a custom\n * `filterToQuery` function prop:\n *\n * @example\n * <ReferenceArrayInput\n *      source=\"tag_ids\"\n *      reference=\"tags\"\n *      filterToQuery={searchText => ({ name: searchText })}>\n *     <SelectArrayInput optionText=\"name\" />\n * </ReferenceArrayInput>\n */\n\nvar ReferenceArrayInput = exports.ReferenceArrayInput = function (_Component) {\n    (0, _inherits3.default)(ReferenceArrayInput, _Component);\n\n    function ReferenceArrayInput(props) {\n        (0, _classCallCheck3.default)(this, ReferenceArrayInput);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (ReferenceArrayInput.__proto__ || Object.getPrototypeOf(ReferenceArrayInput)).call(this, props));\n\n        _initialiseProps.call(_this);\n\n        var perPage = props.perPage,\n            sort = props.sort,\n            filter = props.filter;\n        // stored as a property rather than state because we don't want redraw of async updates\n\n        _this.params = { pagination: { page: 1, perPage: perPage }, sort: sort, filter: filter };\n        _this.debouncedSetFilter = (0, _lodash2.default)(_this.setFilter.bind(_this), 500);\n        return _this;\n    }\n\n    (0, _createClass3.default)(ReferenceArrayInput, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            this.fetchReferenceAndOptions();\n        }\n    }, {\n        key: 'componentWillReceiveProps',\n        value: function componentWillReceiveProps(nextProps) {\n            if (this.props.record.id !== nextProps.record.id) {\n                this.fetchReferenceAndOptions(nextProps);\n            }\n        }\n    }, {\n        key: 'fetchReferenceAndOptions',\n        value: function fetchReferenceAndOptions() {\n            var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props,\n                input = _ref2.input,\n                reference = _ref2.reference,\n                source = _ref2.source,\n                resource = _ref2.resource;\n\n            var _params = this.params,\n                pagination = _params.pagination,\n                sort = _params.sort,\n                filter = _params.filter;\n\n            var ids = input.value;\n            if (ids) {\n                if (!Array.isArray(ids)) {\n                    throw Error('The value of ReferenceArrayInput should be an array');\n                }\n                this.props.crudGetMany(reference, ids);\n            }\n            this.props.crudGetMatching(reference, referenceSource(resource, source), pagination, sort, filter);\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _props = this.props,\n                input = _props.input,\n                resource = _props.resource,\n                label = _props.label,\n                source = _props.source,\n                allowEmpty = _props.allowEmpty,\n                matchingReferences = _props.matchingReferences,\n                basePath = _props.basePath,\n                onChange = _props.onChange,\n                children = _props.children,\n                meta = _props.meta,\n                translate = _props.translate,\n                referenceRecords = _props.referenceRecords;\n\n\n            if (_react2.default.Children.count(children) !== 1) {\n                throw new Error('<ReferenceArrayInput> only accepts a single child (like <Datagrid>)');\n            }\n\n            var translatedLabel = translate(label || 'resources.' + resource + '.fields.' + source);\n\n            var dataStatus = getDataStatus({\n                input: input,\n                matchingReferences: matchingReferences,\n                referenceRecords: referenceRecords,\n                translate: translate\n            });\n\n            if (dataStatus.waiting) {\n                return _react2.default.createElement(_ReferenceLoadingProgress2.default, { label: translatedLabel });\n            }\n\n            if (dataStatus.error) {\n                return _react2.default.createElement(_ReferenceError2.default, {\n                    label: translatedLabel,\n                    error: translate('aor.input.references.all_missing', {\n                        _: 'aor.input.references.all_missing'\n                    })\n                });\n            }\n\n            return _react2.default.cloneElement(children, {\n                allowEmpty: allowEmpty,\n                input: input,\n                label: translatedLabel,\n                resource: resource,\n                meta: dataStatus.warning ? (0, _extends3.default)({}, meta, {\n                    error: dataStatus.warning,\n                    touched: true\n                }) : meta,\n                source: source,\n                choices: dataStatus.choices,\n                basePath: basePath,\n                onChange: onChange,\n                setFilter: this.debouncedSetFilter,\n                setPagination: this.setPagination,\n                setSort: this.setSort,\n                translateChoice: false\n            });\n        }\n    }]);\n    return ReferenceArrayInput;\n}(_react.Component);\n\nvar _initialiseProps = function _initialiseProps() {\n    var _this2 = this;\n\n    this.setFilter = function (filter) {\n        if (filter !== _this2.params.filter) {\n            _this2.params.filter = _this2.props.filterToQuery(filter);\n            _this2.fetchReferenceAndOptions();\n        }\n    };\n\n    this.setPagination = function (pagination) {\n        if (pagination !== _this2.param.pagination) {\n            _this2.param.pagination = pagination;\n            _this2.fetchReferenceAndOptions();\n        }\n    };\n\n    this.setSort = function (sort) {\n        if (sort !== _this2.params.sort) {\n            _this2.params.sort = sort;\n            _this2.fetchReferenceAndOptions();\n        }\n    };\n};\n\nReferenceArrayInput.propTypes = {\n    addField: _propTypes2.default.bool.isRequired,\n    allowEmpty: _propTypes2.default.bool.isRequired,\n    basePath: _propTypes2.default.string,\n    children: _propTypes2.default.element.isRequired,\n    crudGetMatching: _propTypes2.default.func.isRequired,\n    crudGetMany: _propTypes2.default.func.isRequired,\n    filter: _propTypes2.default.object,\n    filterToQuery: _propTypes2.default.func.isRequired,\n    input: _propTypes2.default.object.isRequired,\n    label: _propTypes2.default.string,\n    matchingReferences: _propTypes2.default.array,\n    meta: _propTypes2.default.object,\n    onChange: _propTypes2.default.func,\n    perPage: _propTypes2.default.number,\n    reference: _propTypes2.default.string.isRequired,\n    referenceRecords: _propTypes2.default.array,\n    resource: _propTypes2.default.string.isRequired,\n    sort: _propTypes2.default.shape({\n        field: _propTypes2.default.string,\n        order: _propTypes2.default.oneOf(['ASC', 'DESC'])\n    }),\n    source: _propTypes2.default.string,\n    translate: _propTypes2.default.func.isRequired\n};\n\nReferenceArrayInput.defaultProps = {\n    allowEmpty: false,\n    filter: {},\n    filterToQuery: function filterToQuery(searchText) {\n        return { q: searchText };\n    },\n    matchingReferences: null,\n    perPage: 25,\n    referenceRecords: [],\n    sort: { field: 'id', order: 'DESC' }\n};\n\nfunction mapStateToProps(state, props) {\n    var referenceIds = props.input.value || [];\n    var data = state.admin.resources[props.reference].data;\n    return {\n        matchingReferences: (0, _possibleValues.getPossibleReferences)(state, referenceSource(props.resource, props.source), props.reference, referenceIds),\n        referenceRecords: referenceIds.reduce(function (references, referenceId) {\n            if (data[referenceId]) {\n                references.push(data[referenceId]);\n            }\n            return references;\n        }, [])\n    };\n}\n\nvar ConnectedReferenceArrayInput = (0, _reactRedux.connect)(mapStateToProps, {\n    crudGetMany: _dataActions.crudGetMany,\n    crudGetMatching: _dataActions.crudGetMatching\n})((0, _translate2.default)(ReferenceArrayInput));\n\nConnectedReferenceArrayInput.defaultProps = {\n    addField: true\n};\n\nexports.default = ConnectedReferenceArrayInput;"]},"metadata":{},"sourceType":"script"}