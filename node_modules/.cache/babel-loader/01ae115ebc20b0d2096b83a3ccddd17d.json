{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.flattenObject = exports.queryParameters = exports.fetchJson = undefined;\n\nvar _defineProperty2 = require('babel-runtime/helpers/defineProperty');\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _HttpError = require('./HttpError');\n\nvar _HttpError2 = _interopRequireDefault(_HttpError);\n\nvar _queryString = require('query-string');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar fetchJson = exports.fetchJson = function fetchJson(url) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var requestHeaders = options.headers || new Headers({\n    Accept: 'application/json'\n  });\n\n  if (!requestHeaders.has('Content-Type') && !(options && options.body && options.body instanceof FormData)) {\n    requestHeaders.set('Content-Type', 'application/json');\n  }\n\n  if (options.user && options.user.authenticated && options.user.token) {\n    requestHeaders.set('Authorization', options.user.token);\n  }\n\n  return fetch(url, (0, _extends3.default)({}, options, {\n    headers: requestHeaders\n  })).then(function (response) {\n    return response.text().then(function (text) {\n      return {\n        status: response.status,\n        statusText: response.statusText,\n        headers: response.headers,\n        body: text\n      };\n    });\n  }).then(function (_ref) {\n    var status = _ref.status,\n        statusText = _ref.statusText,\n        headers = _ref.headers,\n        body = _ref.body;\n    var json = void 0;\n\n    try {\n      json = JSON.parse(body);\n    } catch (e) {// not json, no big deal\n    }\n\n    if (status < 200 || status >= 300) {\n      return Promise.reject(new _HttpError2.default(json && json.message || statusText, status, json));\n    }\n\n    return {\n      status: status,\n      headers: headers,\n      body: body,\n      json: json\n    };\n  });\n};\n\nvar queryParameters = exports.queryParameters = _queryString.stringify;\n\nvar isValidObject = function isValidObject(value) {\n  if (!value) {\n    return false;\n  }\n\n  var isArray = Array.isArray(value);\n  var isBuffer = Buffer.isBuffer(value);\n  var isObject = Object.prototype.toString.call(value) === '[object Object]';\n  var hasKeys = !!Object.keys(value).length;\n  return !isArray && !isBuffer && isObject && hasKeys;\n};\n\nvar flattenObject = exports.flattenObject = function flattenObject(value) {\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n  if (isValidObject(value)) {\n    return Object.assign.apply(Object, [{}].concat((0, _toConsumableArray3.default)(Object.keys(value).map(function (key) {\n      return flattenObject(value[key], path.concat([key]));\n    }))));\n  } else {\n    return path.length ? (0, _defineProperty3.default)({}, path.join('.'), value) : value;\n  }\n};","map":{"version":3,"sources":["C:/Users/m2bab/VM/rd2/frontend/node_modules/admin-on-rest/lib/util/fetch.js"],"names":["Object","defineProperty","exports","value","flattenObject","queryParameters","fetchJson","undefined","_defineProperty2","require","_defineProperty3","_interopRequireDefault","_toConsumableArray2","_toConsumableArray3","_extends2","_extends3","_HttpError","_HttpError2","_queryString","obj","__esModule","default","url","options","arguments","length","requestHeaders","headers","Headers","Accept","has","body","FormData","set","user","authenticated","token","fetch","then","response","text","status","statusText","_ref","json","JSON","parse","e","Promise","reject","message","stringify","isValidObject","isArray","Array","isBuffer","Buffer","isObject","prototype","toString","call","hasKeys","keys","path","assign","apply","concat","map","key","join"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.flattenObject = exports.queryParameters = exports.fetchJson = undefined;\n\nvar _defineProperty2 = require('babel-runtime/helpers/defineProperty');\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _HttpError = require('./HttpError');\n\nvar _HttpError2 = _interopRequireDefault(_HttpError);\n\nvar _queryString = require('query-string');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar fetchJson = exports.fetchJson = function fetchJson(url) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var requestHeaders = options.headers || new Headers({\n        Accept: 'application/json'\n    });\n    if (!requestHeaders.has('Content-Type') && !(options && options.body && options.body instanceof FormData)) {\n        requestHeaders.set('Content-Type', 'application/json');\n    }\n    if (options.user && options.user.authenticated && options.user.token) {\n        requestHeaders.set('Authorization', options.user.token);\n    }\n\n    return fetch(url, (0, _extends3.default)({}, options, { headers: requestHeaders })).then(function (response) {\n        return response.text().then(function (text) {\n            return {\n                status: response.status,\n                statusText: response.statusText,\n                headers: response.headers,\n                body: text\n            };\n        });\n    }).then(function (_ref) {\n        var status = _ref.status,\n            statusText = _ref.statusText,\n            headers = _ref.headers,\n            body = _ref.body;\n\n        var json = void 0;\n        try {\n            json = JSON.parse(body);\n        } catch (e) {\n            // not json, no big deal\n        }\n        if (status < 200 || status >= 300) {\n            return Promise.reject(new _HttpError2.default(json && json.message || statusText, status, json));\n        }\n        return { status: status, headers: headers, body: body, json: json };\n    });\n};\n\nvar queryParameters = exports.queryParameters = _queryString.stringify;\n\nvar isValidObject = function isValidObject(value) {\n    if (!value) {\n        return false;\n    }\n\n    var isArray = Array.isArray(value);\n    var isBuffer = Buffer.isBuffer(value);\n    var isObject = Object.prototype.toString.call(value) === '[object Object]';\n    var hasKeys = !!Object.keys(value).length;\n\n    return !isArray && !isBuffer && isObject && hasKeys;\n};\n\nvar flattenObject = exports.flattenObject = function flattenObject(value) {\n    var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n    if (isValidObject(value)) {\n        return Object.assign.apply(Object, [{}].concat((0, _toConsumableArray3.default)(Object.keys(value).map(function (key) {\n            return flattenObject(value[key], path.concat([key]));\n        }))));\n    } else {\n        return path.length ? (0, _defineProperty3.default)({}, path.join('.'), value) : value;\n    }\n};"]},"metadata":{},"sourceType":"script"}